var ran=function(t){var e={};function s(r){if(e[r])return e[r].exports;var h=e[r]={i:r,l:!1,exports:{}};return t[r].call(h.exports,h,h.exports,s),h.l=!0,h.exports}return s.m=t,s.c=e,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)s.d(r,h,function(e){return t[e]}.bind(null,h));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";function r(t,e=1){return 1!==e?t.reduce((t,s)=>t+Math.pow(s,e),0):t.reduce((t,e)=>t+e,0)}function h(t,e){return t<e?Math.random()*(e-t)+t:Math.random()*(t-e)+e}function a(t,e=1){return e<2?t():Array.from({length:e},()=>t())}s.r(e);var i=function(){return{float:function(t,e,s){return 0===arguments.length?Math.random():1===arguments.length?Math.random()*t:a(()=>h(t,e),s)},int:function(t,e,s){return 1===arguments.length?Math.floor(Math.random()*(t+1)):a(()=>Math.floor(h(t,e+1)),s)},choice:function(t,e){return null==t||0===t.length?null:a(()=>t[Math.floor(Math.random()*t.length)],e)},char:function(t,e){return null==t||0===t.length?null:a(()=>t.charAt(Math.floor(Math.random()*t.length)),e)},shuffle:function(t){let e,s,r=t.length;for(;r;)e=Math.floor(Math.random()*r--),s=t[r],t[r]=t[e],t[e]=s;return t},coin:function(t,e,s=.5,r=1){return a(()=>Math.random()<s?t:e,r)}}}(),n=function(){class t{constructor(t){"number"==typeof t?(this._v=new Array(t).fill(0),this._v[0]=1):Array.isArray(t)?this._v=t:"object"==typeof t&&Array.isArray(t._v)?this._v=t._v:this._v=[1,0,0]}v(){return this._v}i(t,e){if(void 0===e)return this._v[t];this._v[t]=e}f(e){return new t(this._v.map(t=>e(t)))}scale(e){return new t(this._v.map(t=>t*e))}add(e){let s=e.v();return new t(this._v.map((t,e)=>t+s[e]))}dot(t){let e=t.v();return this._v.reduce((t,s,r)=>t+s*e[r],0)}}class e{constructor(t){if("number"==typeof t){this._m=Array.from({length:t},()=>new Array(t).fill(0));for(let e=0;e<t;e++)this._m[e][e]=1}else Array.isArray(t)?this._m=t:"object"==typeof t&&Array.isArray(t._m)?this._m=t._m:this._m=[[1,0,0],[0,1,0],[0,0,1]]}m(){return this._m.map(t=>t.slice())}ij(t,e,s){if(void 0===s)return this._m[t][e];this._m[t][e]=s}f(t){return new e(this._m.map(e=>e.map(e=>t(e))))}scale(t){return this.f(e=>e*t)}add(t){let s=t.m();return new e(this._m.map((t,e)=>t.map((t,r)=>t+s[e][r])))}mult(t){let s=t.m(),r=this._m.length,h=new e(r);for(let t=0;t<r;t++)for(let e=0;e<r;e++){let a=0;for(let h=0;h<r;h++)a+=this._m[t][h]*s[h][e];h.ij(t,e,a)}return h}t(){return new e(this._m[0].map((t,e)=>this._m.map(t=>t[e])))}act(e){return new t(this._m.map(s=>e.dot(new t(s))))}ldl(){let t=this._m.length,s=new e(t),r=new e(t);for(let e=0;e<t;e++){let h=this.ij(e,e);for(let t=0;t<e;t++)h-=s.ij(t,t)*r.ij(e,t)*r.ij(e,t);s.ij(e,e,h);for(let a=t-1;a>e;a--){let t=this.ij(a,e);for(let h=0;h<e;h++)t-=s.ij(h,h)*r.ij(a,h)*r.ij(e,h);r.ij(a,e,t/h)}}return{D:s,L:r}}}return{Vector:t,Matrix:e}}(),p=function(){const t=100,e=1e-10;let s=function(){const t=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];return function e(s){let r=0;if(s<.5)r=Math.PI/(Math.sin(Math.PI*s)*e(1-s));else{s--;let e=.9999999999998099,h=t.length;t.forEach((t,a)=>{e+=t/(s+a+1);let i=s+h-.5;r=Math.sqrt(2*Math.PI)*Math.pow(i,s+.5)*Math.exp(-i)*e})}return r}}(),r=function(){const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];return function(e){let s=e,r=e,h=s+5.5;h=(s+.5)*Math.log(h)-h;let a=1.000000000190015;for(let e=0;e<6;e++)a+=t[e]/++r;return h+Math.log(2.5066282746310007*a/s)}}(),h=function(){const r=1e-30;return function(h,a){return a<h+1?function(s,r){if(r<0)return 0;{let h=s,a=1/s,i=1/s;for(let s=0;s<t&&!((a*=r/++h)<(i+=a)*e);s++);return Math.exp(-r)*Math.pow(r,s)*i}}(h,a):s(h)-function(s,h){let a,i,n=h+1-s,p=1/r,o=1/n,l=o;for(let h=1;h<t&&(o=(a=h*(s-h))*o+(n+=2),o=1/(o=Math.max(Math.abs(o),r)),p=n+a/p,l*=i=(p=Math.max(Math.abs(p),r))*o,!(Math.abs(i-1)<e));h++);return Math.exp(-h)*Math.pow(h,s)*l}(h,a)}}();return{beta:function(t,e){return Math.exp(r(t)+r(e)-r(t+e))},betaIncomplete:function(){const s=1e-30;function h(r,h,a){let i=r+h,n=r+1,p=r-1,o=1,l=1-i*a/n,u=l=1/(l=Math.max(Math.abs(l),s));for(let c=1;c<t;c++){let t=2*c,m=c*(h-c)*a/((p+t)*(r+t));l=1+m*l,o=1+m/o,u*=(l=1/(l=Math.max(Math.abs(l),s)))*(o=Math.max(Math.abs(o),s)),l=1+(m=-(r+c)*(i+c)*a/((r+t)*(n+t)))*l,o=1+m/o;let d=(l=1/(l=Math.max(Math.abs(l),s)))*(o=Math.max(Math.abs(o),s));if(u*=d,Math.abs(d-1)<e)break}return u}return function(t,e,s){let a=s<=0||s>=1?0:Math.exp(r(t+e)-r(t)-r(e)+t*Math.log(s)+e*Math.log(1-s));return s<(t+1)/(t+e+2)?a*h(t,e,s)/t:1-a*h(e,t,1-s)/e}}(),erf:function(){const t=[-1.26551223,1.00002368,.37409196,.09678418,-.18628806,.27886807,-1.13520398,1.48851587,-.82215223,.17087277];return function(e){let s=1/(1+.5*Math.abs(e)),r=1,h=0;t.forEach(t=>{h+=t*r,r*=s});let a=s*Math.exp(h-e*e);return e<0?a-1:1-a}}(),gamma:s,gammaLn:r,gammaLowerIncomplete:h}}(),o=function(){const t=1e3,e=[0,6.635,9.21,11.345,13.277,15.086,16.812,18.475,20.09,21.666,23.209,24.725,26.217,27.688,29.141,30.578,32,33.409,34.805,36.191,37.566,38.932,40.289,41.638,42.98,44.314,45.642,46.963,48.278,49.588,50.892,52.191,53.486,54.776,56.061,57.342,58.619,59.893,61.162,62.428,63.691,64.95,66.206,67.459,68.71,69.957,71.201,72.443,73.683,74.919,76.154,77.386,78.616,79.843,81.069,82.292,83.513,84.733,85.95,87.166,88.379,89.591,90.802,92.01,93.217,94.422,95.626,96.828,98.028,99.228,100.425,101.621,102.816,104.01,105.202,106.393,107.583,108.771,109.958,111.144,112.329,113.512,114.695,115.876,117.057,118.236,119.414,120.591,121.767,122.942,124.116,125.289,126.462,127.633,128.803,129.973,131.141,132.309,133.476,134.642,135.807,136.971,138.134,139.297,140.459,141.62,142.78,143.94,145.099,146.257,147.414,148.571,149.727,150.882,152.037,153.191,154.344,155.496,156.648,157.8,158.95,160.1,161.25,162.398,163.546,164.694,165.841,166.987,168.133,169.278,170.423,171.567,172.711,173.854,174.996,176.138,177.28,178.421,179.561,180.701,181.84,182.979,184.118,185.256,186.393,187.53,188.666,189.802,190.938,192.073,193.208,194.342,195.476,196.609,197.742,198.874,200.006,201.138,202.269,203.4,204.53,205.66,206.79,207.919,209.047,210.176,211.304,212.431,213.558,214.685,215.812,216.938,218.063,219.189,220.314,221.438,222.563,223.687,224.81,225.933,227.056,228.179,229.301,230.423,231.544,232.665,233.786,234.907,236.027,237.147,238.266,239.386,240.505,241.623,242.742,243.86,244.977,246.095,247.212,248.329,249.445,250.561,251.677,252.793,253.908,255.023,256.138,257.253,258.367,259.481,260.595,261.708,262.821,263.934,265.047,266.159,267.271,268.383,269.495,270.606,271.717,272.828,273.939,275.049,276.159,277.269,278.379,279.488,280.597,281.706,282.814,283.923,285.031,286.139,287.247,288.354,289.461,290.568,291.675,292.782,293.888,294.994,296.1,297.206,298.311,299.417,300.522,301.626,302.731,303.835,304.94],s=[359.906,414.474,468.724,522.717,576.493,630.084,683.516,736.807,789.974,843.029,895.984,948.848,1001.63,1054.334,1106.969];function r(t=0,e=1){let s=Math.random(),r=Math.random();return e*Math.sqrt(-2*Math.log(s))*Math.cos(2*Math.PI*r)+t}function h(e,s){if(!(e>1))return h(e+1,s)*Math.pow(Math.random(),1/e);{let h,a,i,n=e-1/3,p=1/Math.sqrt(9*n);for(let e=0;e<t;e++)if((h=r(0,1))>-1/p&&(a=Math.pow(1+p*h,3),i=Math.random(),Math.log(i)<.5*h*h+n*(1-a+Math.log(a))))return n*a/s}}class i{constructor(t,e){this._type=t,this.k=e,this.p=[],this.c=[]}_generator(){throw Error("Distribution._generator() is not implemented")}_pdf(){throw Error("Distribution._pdf() is not implemented")}_cdf(){throw Error("Distribution._cdf() is not implemented")}type(){return this._type}support(){throw Error("Distribution.support() is not implemented")}sample(t){return a(()=>this._generator(),t)}pdf(t){return this._pdf(t)}cdf(t){return this._cdf(t)}survival(t){return 1-this._cdf(t)}hazard(t){return this._pdf(t)/this.survival(t)}cHazard(t){return-Math.log(this.survival(t))}lnPdf(t){return Math.log(this._pdf(t))}L(t){return t.reduce((t,e)=>t+this.lnPdf(e),0)}test(t){return"discrete"===this._type?function(t,r,h){let a=new Map;t.forEach(function(t){a.set(t,a.has(t)?a.get(t)+1:1)});let i=0,n=t.length;a.forEach((t,e)=>{let s=r(parseInt(e))*n;i+=Math.pow(t-s,2)/s});let p=Math.max(1,a.size-h-1),o=p<=250?e[p]:s[Math.floor(p/50)];return{statistics:i,passed:i<=o}}(t,t=>this._pdf(t),this.k):function(t,e){t.sort((t,e)=>t-e);let s=0;for(let r=0;r<t.length;r++)s=Math.max(s,Math.abs((r+1)/t.length-e(t[r])));return{statistics:s,passed:s<=1.628/Math.sqrt(t.length)}}(t,t=>this._cdf(t))}}class n extends i{constructor(t=1,e=1){super("continuous",arguments.length),this.p={alpha:t,beta:e},this.c=[Math.pow(e,t),p.gamma(t)]}_generator(){return h(this.p.alpha,this.p.beta)}_pdf(t){return t>0?this.c[0]*Math.exp((this.p.alpha-1)*Math.log(t)-this.p.beta*t)/this.c[1]:0}_cdf(t){return p.gammaLowerIncomplete(this.p.alpha,this.p.beta*t)/this.c[1]}support(){return[{value:0,closed:!0},{value:null,closed:!1}]}}class o extends i{constructor(t=1,e=1){super("continuous",arguments.length),this.p={lambda:t,mu:e},this.c=[.5*this.p.mu/this.p.lambda,Math.exp(2*t/e)]}static _phi(t){return.5*(1+p.erf(t/Math.SQRT2))}_generator(){let t=r(),e=t*t,s=this.p.mu+this.c[0]*this.p.mu*e-this.c[0]*Math.sqrt(this.p.mu*e*(4*this.p.lambda+this.p.mu*e));return Math.random()>this.p.mu/(this.p.mu+s)?this.p.mu*this.p.mu/s:s}_pdf(t){return t>0?Math.sqrt(this.p.lambda/(2*Math.PI*Math.pow(t,3)))*Math.exp(-this.p.lambda*Math.pow(t-this.p.mu,2)/(2*this.p.mu*this.p.mu*t)):0}_cdf(t){let e=Math.sqrt(this.p.lambda/t),s=t/this.p.mu;return t>0?o._phi(e*(s-1))+this.c[1]*o._phi(-e*(s+1)):0}support(){return[{value:0,closed:!0},{value:null,closed:!1}]}}class l extends i{constructor(t=1,e=1){super("continuous",arguments.length),this.p={lambda:t,k:e}}_generator(){return this.p.lambda*Math.pow(-Math.log(Math.random()),1/this.p.k)}_pdf(t){return t<0?0:this.p.k/this.p.lambda*Math.exp((this.p.k-1)*Math.log(t/this.p.lambda)-Math.pow(t/this.p.lambda,this.p.k))}_cdf(t){return t<0?0:1-Math.exp(-Math.pow(t/this.p.lambda,this.p.k))}support(){return[{value:0,closed:!0},{value:null,closed:!1}]}}return{Arcsine:class extends i{constructor(t=0,e=1){super("continuous",arguments.length),this.p={a:t,b:e},this.c=[1/Math.PI,e-t]}_generator(){let t=Math.sin(.5*Math.PI*Math.random());return t*t*this.c[1]+this.p.a}_pdf(t){return t>=this.p.a&&t<this.p.b?this.c[0]/Math.sqrt((t-this.p.a)*(this.p.b-t)):0}_cdf(t){return t>=this.p.a&&t<this.p.b?2*this.c[0]*Math.asin(Math.sqrt((t-this.p.a)/(this.p.b-this.p.a))):0}support(){return[{value:this.p.a,closed:!0},{value:this.p.b,closed:!0}]}},Bernoulli:class extends i{constructor(t=.5){super("discrete",arguments.length),this.p={p:t}}_generator(){return Math.random()<this.p.p?1:0}_pdf(t){let e=parseInt(t);return 1===e?this.p.p:0===e?1-this.p.p:0}_cdf(t){return t<0?0:parseInt(t)>=1?1:1-this.p.p}support(){return[{value:0,closed:!0},{value:1,closed:!0}]}},Beta:class extends i{constructor(t=1,e=1){super("continuous",arguments.length),this.p={alpha:t,beta:e},this.c=[p.beta(t,e)]}_generator(){let t=h(this.p.alpha,1);return t/(t+h(this.p.beta,1))}_pdf(t){return t>0&&t<1?Math.pow(t,this.p.alpha-1)*Math.pow(1-t,this.p.beta-1)/this.c[0]:0}_cdf(t){return t<=0?0:t>=1?1:p.betaIncomplete(this.p.alpha,this.p.beta,t)}support(){return[{value:0,closed:this.p.alpha>=1},{value:1,closed:this.p.beta>=1}]}},BetaPrime:class extends i{constructor(t=2,e=2){super("continuous",arguments.length),this.p={alpha:t,beta:e}}_generator(){return h(this.p.alpha,1)/h(this.p.beta,1)}_pdf(t){return t>0?Math.pow(t,this.p.alpha-1)*Math.pow(1+t,-this.p.alpha-this.p.beta)/p.beta(this.p.alpha,this.p.beta):0}_cdf(t){return t>0?p.betaIncomplete(this.p.alpha,this.p.beta,t/(1+t)):0}support(){return[{value:0,closed:this.p.alpha>=1},{value:null,closed:!1}]}},Binomial:class extends i{constructor(t=100,e=.5){super("discrete",arguments.length);let s=e<=.5?e:1-e;this.p={n:t,p:e},this.c=[s,t*s]}_generator(){if(this.p.n<25){let t=0;for(let e=1;e<=this.p.n;e++)Math.random()<this.c[0]&&t++;return this.c[0]===this.p.p?t:this.p.n-t}if(this.c[1]<1){let t,e=Math.exp(-this.c[1]),s=1;for(t=0;t<=this.p.n&&!((s*=Math.random())<e);t++);let r=Math.min(t,this.p.n);return this.c[0]===this.p.p?r:this.p.n-r}{let t,e,s,r=this.p.n,h=p.gammaLn(r+1),a=1-this.c[0],i=Math.log(this.c[0]),n=Math.log(a),o=Math.sqrt(2*this.c[1]*a);do{do{e=o*(t=Math.tan(Math.PI*Math.random()))+this.c[1]}while(e<0||e>=r+1);e=Math.floor(e),s=1.2*o*(1+t*t)*Math.exp(h-p.gammaLn(e+1)-p.gammaLn(r-e+1)+e*i+(r-e)*n)}while(Math.random()>s);return this.c[0]===this.p.p?e:this.p.n-e}}_pdf(t){let e=parseInt(t);return e<0?0:e>this.p.n?0:Math.exp(p.gammaLn(this.p.n+1)-p.gammaLn(e+1)-p.gammaLn(this.p.n-e+1)+e*Math.log(this.p.p)+(this.p.n-e)*Math.log(1-this.p.p))}_cdf(t){let e=parseInt(t);return e<0?0:e>=this.p.n?1:p.betaIncomplete(this.p.n-e,1+e,1-this.p.p)}support(){return[{value:0,closed:!0},{value:this.p.n,closed:!0}]}},BoundedPareto:class extends i{constructor(t=1,e=10,s=1){super("continuous",arguments.length),this.p={L:t,H:e,alpha:s},this.c=[Math.pow(t,s),Math.pow(e,s),1-Math.pow(t/e,s)]}_generator(){return Math.pow((this.c[1]+Math.random()*(this.c[0]-this.c[1]))/(this.c[0]*this.c[1]),-1/this.p.alpha)}_pdf(t){return t<this.p.L||t>this.p.H?0:this.p.alpha*Math.pow(this.p.L/t,this.p.alpha)/(t*this.c[2])}_cdf(t){return t<this.p.L?0:t>this.p.H?1:(1-this.c[0]*Math.pow(t,-this.p.alpha))/(1-this.c[0]/this.c[1])}support(){return[{value:this.p.L,closed:!0},{value:this.p.H,closed:!0}]}},Cauchy:class extends i{constructor(t=0,e=1){super("continuous",arguments.length),this.p={x0:t,gamma:e},this.c=[Math.PI*this.p.gamma]}_generator(){return this.p.x0+this.p.gamma*Math.tan(Math.PI*(Math.random()-.5))}_pdf(t){let e=(t-this.p.x0)/this.p.gamma;return 1/(this.c[0]*(1+e*e))}_cdf(t){return.5+Math.atan2(t-this.p.x0,this.p.gamma)/Math.PI}support(){return[{value:null,closed:!1},{value:null,closed:!1}]}},Chi2:class extends n{constructor(t=2){super(Math.round(t)/2,.5)}},Custom:class extends i{constructor(t=[1]){super("discrete",arguments.length),this.p={n:t.length,weights:t};let e=t.length,s=[0],r=[0],h=0;if(t.length>1){for(let s=0;s<e;s++)h+=t[s];let a=[],i=[],n=[];for(let s=0;s<e;s++)a.push(e*t[s]/h),a[s]<1?i.push(s):n.push(s);s=[],r=[];for(let t=0;t<e;t++)s.push(1),r.push(t);let p=0,o=0;for(;i.length>0&&n.length>0;)p=i.shift(),o=n.shift(),s[p]=a[p],r[p]=o,a[o]+=a[p]-1,a[o]<1?i.push(o):n.push(o);for(;n.length>0;)s[o=n.shift()]=1,r[o]=o;for(;i.length>0;)s[p=i.shift()]=1,r[p]=p}let a=[t[0]/h],i=[t[0]/h];for(let e=1;e<t.length;e++)a.push(t[e]/h),i.push(i[e-1]+t[e]/h);this.c=[s,r,a,i]}_generator(){if(this.p.n<=1)return 0;let t=Math.floor(Math.random()*this.p.n);return Math.random()<this.c[0][t]?t:this.c[1][t]}_pdf(t){let e=parseInt(t);return this.p.n<=1?0!==e?0:1:e<0||e>=this.p.n?0:this.c[2][e]}_cdf(t){let e=parseInt(t);return this.p.n<=1?e<0?0:1:e<0?0:e>=this.p.n?1:this.c[3][e]}support(){return[{value:0,closed:!0},{value:Math.max(0,this.p.n-1),closed:!0}]}},Degenerate:class extends i{constructor(t=0){super("continuous",arguments.length),this.p={x0:t}}_generator(){return this.p.x0}_pdf(t){return t===this.p.x0?1:0}_cdf(t){return t<this.p.x0?0:1}support(){return[{value:this.p.x0,closed:!0},{value:this.p.x0,closed:!0}]}},Erlang:class extends n{constructor(t=1,e=1){super(Math.round(t),e)}},Exponential:class extends i{constructor(t=1){super("continuous",arguments.length),this.p={lambda:t}}_generator(){return-Math.log(Math.random())/this.p.lambda}_pdf(t){return t<0?0:this.p.lambda*Math.exp(-this.p.lambda*t)}_cdf(t){return t<0?0:1-Math.exp(-this.p.lambda*t)}support(){return[{value:0,closed:!0},{value:null,closed:!1}]}},F:class extends i{constructor(t=2,e=2){super("continuous",arguments.length),this.p={d1:t,d2:e},this.c=[p.beta(t/2,e/2),Math.pow(e,e)]}_generator(){return this.p.d2*h(this.p.d1/2,1)/(this.p.d1*h(this.p.d2/2,1))}_pdf(t){return t>0?Math.sqrt(Math.pow(this.p.d1*t,this.p.d1)*this.c[1]/Math.pow(this.p.d1*t+this.p.d2,this.p.d1+this.p.d2))/(t*this.c[0]):0}_cdf(t){return t>0?p.betaIncomplete(this.p.d1/2,this.p.d2/2,this.p.d1*t/(this.p.d1*t+this.p.d2)):0}support(){return[{value:0,closed:1!==this.p.d1},{value:null,closed:!1}]}},Frechet:class extends i{constructor(t=1,e=1,s=0){super("continuous",arguments.length),this.p={alpha:t,s:e,m:s}}_generator(){return this.p.m+this.p.s*Math.pow(-Math.log(Math.random()),-1/this.p.alpha)}_pdf(t){if(t<=this.p.m)return 0;{let e=(t-this.p.m)/this.p.s;return this.p.alpha*Math.pow(e,-1-this.p.alpha)*Math.exp(-Math.pow(e,-this.p.alpha))/this.p.s}}_cdf(t){return t<=this.p.m?0:Math.exp(-Math.pow((t-this.p.m)/this.p.s,-this.p.alpha))}support(){return[{value:this.p.m,closed:!1},{value:null,closed:!1}]}},Gamma:n,GeneralizedGamma:class extends i{constructor(t=1,e=1,s=1){super("continuous",arguments.length),this.p={a:t,d:e,p:s},this.c=[p.gamma(e/s),s/Math.pow(t,e),1/Math.pow(t,s)]}_generator(){return Math.pow(h(this.p.d/this.p.p,this.c[2]),1/this.p.p)}_pdf(t){return t>0?this.c[1]*Math.exp((this.p.d-1)*Math.log(t)-Math.pow(t/this.p.a,this.p.p))/this.c[0]:0}_cdf(t){return t>0?p.gammaLowerIncomplete(this.p.d/this.p.p,Math.pow(t/this.p.a,this.p.p))/this.c[0]:0}support(){return[{value:0,closed:this.p.d>=1},{value:null,closed:!1}]}},Gompertz:class extends i{constructor(t=1,e=1){super("continuous",arguments.length),this.p={eta:t,b:e}}_generator(){return Math.log(1-Math.log(Math.random())/this.p.eta)/this.p.b}_pdf(t){return t<0?0:this.p.b*this.p.eta*Math.exp(this.p.eta+this.p.b*t-this.p.eta*Math.exp(this.p.b*t))}_cdf(t){return t<0?0:1-Math.exp(-this.p.eta*(Math.exp(this.p.b*t)-1))}support(){return[{value:0,closed:!0},{value:null,closed:!1}]}},Gumbel:class extends i{constructor(t=0,e=1){super("continuous",arguments.length),this.p={mu:t,beta:e}}_generator(){return this.p.mu-this.p.beta*Math.log(-Math.log(Math.random()))}_pdf(t){let e=(t-this.p.mu)/this.p.beta;return Math.exp(-(e+Math.exp(-e)))/this.p.beta}_cdf(t){return Math.exp(-Math.exp(-(t-this.p.mu)/this.p.beta))}support(){return[{value:null,closed:!1},{value:null,closed:!1}]}},InverseGamma:class extends i{constructor(t=1,e=1){super("continuous",arguments.length),this.p={alpha:t,beta:e},this.c=[Math.pow(e,t)/p.gamma(t),p.gamma(t)]}_generator(){return 1/h(this.p.alpha,this.p.beta)}_pdf(t){return t>0?this.c[0]*Math.pow(t,-1-this.p.alpha)*Math.exp(-this.p.beta/t):0}_cdf(t){return t>0?1-p.gammaLowerIncomplete(this.p.alpha,this.p.beta/t)/this.c[1]:0}support(){return[{value:0,closed:!1},{value:null,closed:!1}]}},InverseGaussian:o,Laplace:class extends i{constructor(t=0,e=1){super("continuous",arguments.length),this.p={mu:t,b:e}}_generator(){return this.p.b*Math.log(Math.random()/Math.random())+this.p.mu}_pdf(t){return.5*Math.exp(-Math.abs(t-this.p.mu)/this.p.b)/this.p.b}_cdf(t){let e=Math.exp((t-this.p.mu)/this.p.b);return t<this.p.mu?.5*e:1-.5/e}support(){return[{value:null,closed:!1},{value:null,closed:!1}]}},LogCauchy:class extends i{constructor(t=0,e=1){super("continuous",arguments.length),this.p={mu:t,sigma:e}}_generator(){return Math.exp(this.p.mu+this.p.sigma*Math.tan(Math.PI*(Math.random()-.5)))}_pdf(t){return t>0?this.p.sigma/(t*Math.PI*(this.p.sigma*this.p.sigma+Math.pow(Math.log(t)-this.p.mu,2))):0}_cdf(t){return t>0?.5+Math.atan2(Math.log(t)-this.p.mu,this.p.sigma)/Math.PI:0}support(){return[{value:0,closed:!1},{value:null,closed:!1}]}},Logistic:class extends i{constructor(t=0,e=1){super("continuous",arguments.length),this.p={mu:t,s:e}}_generator(){return this.p.mu-this.p.s*Math.log(1/Math.random()-1)}_pdf(t){let e=Math.exp(-(t-this.p.mu)/this.p.s);return e/(this.p.s*Math.pow(1+e,2))}_cdf(t){return 1/(1+Math.exp(-(t-this.p.mu)/this.p.s))}support(){return[{value:null,closed:!1},{value:null,closed:!1}]}},LogLogistic:class extends i{constructor(t=0,e=1,s=1){super("continuous",arguments.length),this.p={mu:t,sigma:e,xi:s}}_generator(){return 0===this.p.xi?this.p.mu-this.p.sigma*Math.log(1/Math.random()-1):this.p.mu+this.p.sigma*(Math.pow(1/Math.random()-1,-this.p.xi)-1)/this.p.xi}_pdf(t){if(0===this.p.xi){let e=Math.exp(-(t-this.p.mu)/this.p.sigma);return e/(this.p.sigma*Math.pow(1+e,2))}{let e=(t-this.p.mu)/this.p.sigma,s=Math.pow(1+this.p.xi*e,-(1/this.p.xi+1))/(this.p.sigma*Math.pow(1+Math.pow(1+this.p.xi*e,-1/this.p.xi),2));return this.p.xi>0?t>=this.p.mu-this.p.sigma/this.p.xi?s:0:t<=this.p.mu-this.p.sigma/this.p.xi?s:0}}_cdf(t){if(0===this.p.xi)return 1/(1+Math.exp(-(t-this.p.mu)/this.p.sigma));{let e=(t-this.p.mu)/this.p.sigma,s=1/(1+Math.pow(1+this.p.xi*e,-1/this.p.xi));return this.p.xi>0?t>=this.p.mu-this.p.sigma/this.p.xi?s:0:t<=this.p.mu-this.p.sigma/this.p.xi?s:0}}support(){return 0===this.p.xi?[{value:null,closed:!1},{value:null,closed:!1}]:[{value:this.p.xi>0?this.p.mu-this.p.sigma/this.p.xi:null,closed:this.p.xi>0},{value:this.p.x<0?this.p.mu-this.p.sigma/this.p.xi:null,closed:this.p.xi<0}]}},Lognormal:class extends i{constructor(t=0,e=1){super("continuous",arguments.length),this.p={mu:t,sigma:e},this.c=[e*Math.sqrt(2*Math.PI),e*Math.SQRT2]}_generator(){return Math.exp(this.p.mu+this.p.sigma*r(0,1))}_pdf(t){return t>0?Math.exp(-.5*Math.pow((Math.log(t)-this.p.mu)/this.p.sigma,2))/(t*this.c[0]):0}_cdf(t){return t>0?.5*(1+p.erf((Math.log(t)-this.p.mu)/this.c[1])):0}support(){return[{value:0,closed:!1},{value:null,closed:!1}]}},Lomax:class extends i{constructor(t=1,e=1){super("continuous",arguments.length),this.p={lambda:t,alpha:e}}_generator(){return this.p.lambda*(Math.pow(Math.random(),-1/this.p.alpha)-1)}_pdf(t){return t<0?0:this.p.alpha*Math.pow(1+t/this.p.lambda,-1-this.p.alpha)/this.p.lambda}_cdf(t){return t<0?0:1-Math.pow(1+t/this.p.lambda,-this.p.alpha)}support(){return[{value:0,closed:!0},{value:null,closed:!1}]}},Minimax:class extends i{constructor(t=1,e=1){super("continuous",arguments.length),this.p={alpha:t,beta:e}}_generator(){return Math.pow(1-Math.pow(1-Math.random(),1/this.p.beta),1/this.p.alpha)}_pdf(t){return t>0&&t<1?this.p.alpha*this.p.beta*Math.pow(t,this.p.alpha-1)*Math.pow(1-Math.pow(t,this.p.alpha),this.p.beta-1):0}_cdf(t){return t>0&&t<1?1-Math.pow(1-Math.pow(t,this.p.alpha),this.p.beta):0}support(){return[{value:0,closed:!1},{value:0,closed:!1}]}},Normal:class extends i{constructor(t=0,e=1){super("continuous",arguments.length),this.p={mu:t,sigma:e},this.c=[e*Math.sqrt(2*Math.PI),e*Math.SQRT2]}_generator(){return r(this.p.mu,this.p.sigma)}_pdf(t){return Math.exp(-.5*Math.pow((t-this.p.mu)/this.p.sigma,2))/this.c[0]}_cdf(t){return.5*(1+p.erf((t-this.p.mu)/this.c[1]))}support(){return[{value:null,closed:!1},{value:null,closed:!1}]}},Pareto:class extends i{constructor(t=1,e=1){super("continuous",arguments.length),this.p={xmin:t,alpha:e}}_generator(){return this.p.xmin/Math.pow(Math.random(),1/this.p.alpha)}_pdf(t){return t<this.p.xmin?0:this.p.alpha*Math.pow(this.p.xmin/t,this.p.alpha)/t}_cdf(t){return t<this.p.xmin?0:1-Math.pow(this.p.xmin/t,this.p.alpha)}support(){return[{value:this.p.xmin,closed:!0},{value:null,closed:!1}]}},Poisson:class extends i{constructor(t=1){super("discrete",arguments.length),this.p={lambda:t}}_generator(){if(this.p.lambda<30){let t=Math.exp(-this.p.lambda),e=0,s=1;do{e++,s*=Math.random()}while(s>t);return e-1}{let e=.767-3.36/this.p.lambda,s=Math.PI/Math.sqrt(3*this.p.lambda),r=s*this.p.lambda,h=Math.log(e)-this.p.lambda-Math.log(s);for(let e=0;e<t;e++){let t,e,a;do{t=Math.random(),e=(r-Math.log((1-t)/t))/s,a=Math.floor(e+.5)}while(a<0);let i=Math.random(),n=r-s*e;if(n+Math.log(i/Math.pow(1+Math.exp(n),2))<=h+a*Math.log(this.p.lambda)-p.gammaLn(a+1))return a}}}_pdf(t){let e=parseInt(t);return e<0?0:Math.pow(this.p.lambda,e)*Math.exp(-this.p.lambda)/p.gamma(e+1)}_cdf(t){let e=parseInt(t);return e<0?0:1-p.gammaLowerIncomplete(e+1,this.p.lambda)/p.gamma(e+1)}support(){return[{value:0,closed:!0},{value:null,closed:!1}]}},Rayleigh:class extends l{constructor(t=1){super(t*Math.SQRT2,2)}},UniformContinuous:class extends i{constructor(t=0,e=1){super("continuous",arguments.length),this.p={xmin:t,xmax:e},this.c=[e-t]}_generator(){return Math.random()*this.c[0]+this.p.xmin}_pdf(t){return t<this.p.xmin||t>this.p.xmax?0:1/this.c[0]}_cdf(t){return t<this.p.xmin?0:t>this.p.xmax?1:(t-this.p.xmin)/this.c[0]}support(){return[{value:this.p.xmin,closed:!0},{value:this.p.xmax,closed:!0}]}},UniformDiscrete:class extends i{constructor(t=0,e=100){super("discrete",arguments.length),this.p={xmin:t,xmax:e},this.c=[e-t+1]}_generator(){return parseInt(Math.random()*this.c[0])+this.p.xmin}_pdf(t){let e=parseInt(t);return e<this.p.xmin||e>this.p.xmax?0:1/this.c[0]}_cdf(t){let e=parseInt(t);return e<this.p.xmin?0:e>this.p.xmax?1:(1+e-this.p.xmin)/this.c[0]}support(){return[{value:this.p.xmin,closed:!0},{value:this.p.xmax,closed:!0}]}},Weibull:l,_InvalidDistribution:class extends i{constructor(){super("discrete",arguments.length)}}}}(),l=function(){return{Cov:class{constructor(t=1){this.dim=t,this.n=0,this.x=new Array(this.dim).fill(0),this.xy=Array.from({length:this.dim},()=>new Array(this.dim).fill(0))}reset(){this.n=0,this.x=new Array(this.dim).fill(0),this.xy=Array.from({length:this.dim},()=>new Array(this.dim).fill(0))}update(t){this.x=this.x.map((e,s)=>(this.n*e+t[s])/(this.n+1)),this.xy=this.xy.map((e,s)=>e.map((e,r)=>(this.n*e+t[s]*t[r])/(this.n+1))),this.n++}compute(){return new n.Matrix(this.xy.map((t,e)=>t.map((t,s)=>t-this.x[e]*this.x[s])))}},AC:class{constructor(t=1,e=100,s=1e4){this.dim=t,this.range=e,this.maxSize=s,this.history=Array.from({length:t},()=>[])}_aci(t){let e=t.reduce((t,e)=>t+e)/t.length,s=t.reduce((t,e)=>t+e*e),r=new Array(this.range).fill(0);for(let s=0;s<t.length;s++)for(let h=0;h<r.length;h++)s-h>0&&(r[h]+=(t[s]-e)*(t[s-h]-e));return r.map(function(r){return r/(s-t.length*e*e)})}reset(){this.history=Array.from({length:this.dim},()=>[])}update(t){this.history.forEach((e,s)=>e.push(t[s])),this.history[0].length>=this.maxSize&&this.history.forEach(t=>t.shift())}compute(){return this.history.reduce((t,e)=>t+e.length,0)>0?this.history.map(t=>this._aci(t)):Array.from({length:this.dim},()=>Array.from({length:this.range},()=>void 0))}}}}(),u=function(){const t=1e4;class e{constructor(e,s={},h={}){this.dim=s.dim||1,this.maxHistory=s.maxHistory||t,this.lnp=e,this.x=h.x||Array.from({length:this.dim},Math.random),this.samplingRate=h.samplingRate||1,this.internal=h.internal||{},this.history=function(t){let e=Array.from({length:t.dim},()=>[]);return{get:()=>e,update(s){e.forEach((t,e)=>t.push(s[e])),e[0].length>=t.maxHistory&&e.forEach(t=>t.shift())}}}(this),this.acceptance=function(t){let e=[];return{compute:()=>r(e)/e.length,update(s){e.push(s),e.length>t.maxHistory&&e.shift()}}}(this)}_internal(){throw Error("MCMC._internal() is not implemented")}_iter(){throw Error("MCMC._iter() is not implemented")}_adjust(){throw Error("MCMC._adjust() is not implemented")}state(){return{x:this.x,samplingRate:this.samplingRate,internals:this._internal()}}statistics(){return this.history.get().map(t=>{let e=t.reduce((t,e)=>t+e,0)/t.length,s=t.reduce((t,s)=>t+(s-e)*(s-e),0)/t.length;return{mean:e,std:s,cv:s/e}})}ar(){return this.acceptance.compute()}ac(){return this.history.get().map(t=>{let e=t.reduce((t,e)=>t+e)/t.length,s=t.reduce((t,e)=>t+e*e),r=new Array(100).fill(0);for(let s=0;s<t.length;s++)for(let h=0;h<r.length;h++)s-h>0&&(r[h]+=(t[s]-e)*(t[s-h]-e));return r.map(function(r){return r/(s-t.length*e*e)})})}iterate(t=null,e=!1){let s=this._iter(this.state.x,e);return this.history.update(s.x),this.acceptance.update(s.accepted),this.x=s.x,t&&t(s.x,s.accepted),s}warmUp(t,e=100){for(let s=0;s<=e;s++){for(let t=0;t<1e4;t++)this._adjust(this.iterate(null,!0));let r=this.ac().reduce((t,e)=>{for(let s=0;s<e.length-1;s++)if(Math.abs(e[s])<=.05)return Math.max(t,s)},0);r>this.samplingRate?this.samplingRate++:r<this.samplingRate&&this.samplingRate>1&&this.samplingRate--,t&&t(100*s/e)}}sample(t,e=1e3){let s=this.samplingRate*e,r=s/100,h=[];for(let e=0;e<s;e++)this.iterate(),e%r==0&&t&&t(e/r),e%this.samplingRate==0&&h.push(this.x);return h}}return{gr:function(){return function(t,e){return t[0][0].map(function(s,h){return new Array(e||1e3).fill(0).map(function(e,s){return function(t,e){let s=[],h=[];t.forEach(function(t){let a=t.map(function(t){return t[e]}),i=r(a)/a.length,n=(r(a,2)-a.length*i*i)/(a.length-1);s.push(i),h.push(n)});let a=r(h)/t.length,i=r(s)/t.length,n=(r(s,2)-t.length*i*i)*t[0].length/(t.length-1),p=((t[0].length-1)*a+n)/t[0].length;return Math.sqrt(p/a)}(t.map(function(t){return t.slice(0,s+2)}),h)})})}}(),RWM:class extends e{constructor(t,e,s){super(t,e,s),this.lastLnp=this.lnp(this.x),this.proposal=function(t){let e=new o.Normal(0,1),s=new Array(t.dim).fill(0),r=t.internal.proposal||new Array(t.dim).fill(1),h=r.map(t=>Math.log(t)),a=0,i=0,n=0;return{jump:(t,s)=>s?t.map((t,s)=>t+(s===n?e.sample()*r[n]:0)):t.map((t,s)=>t+e.sample()*r[s]),update(e){e&&s[n]++,100==++a&&(s[n]/100>.44?h[n]+=Math.min(.01,Math.pow(i,-.5)):h[n]-=Math.min(.01,Math.pow(i,-.5)),r[n]=Math.exp(h[n]),a=0,s[n]=0,0==(n=(n+1)%t.dim)&&i++)},scales:()=>r.slice()}}(this)}_internal(){return{proposal:this.proposal.scales()}}_iter(t,e){let s=this.proposal.jump(this.x,e),r=this.lnp(s),h=Math.random()<Math.exp(r-this.lastLnp);return h?this.lastLnp=r:s=this.x,{x:s,accepted:h}}_adjust(t){this.proposal.update(t.accepted)}}}}();s.d(e,"la",function(){return n}),s.d(e,"ts",function(){return l}),s.d(e,"core",function(){return i}),s.d(e,"dist",function(){return o}),s.d(e,"mc",function(){return u})}]);