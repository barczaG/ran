var ran=function(t){var s={};function e(h){if(s[h])return s[h].exports;var r=s[h]={i:h,l:!1,exports:{}};return t[h].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=s,e.d=function(t,s,h){e.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:h})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,s){if(1&s&&(t=e(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.__esModule)return t;var h=Object.create(null);if(e.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var r in t)e.d(h,r,function(s){return t[s]}.bind(null,r));return h},e.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,"a",s),s},e.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},e.p="",e(e.s=0)}([function(t,s,e){"use strict";function h(t=0,s=1){return t<s?Math.random()*(s-t)+t:Math.random()*(t-s)+s}function r(t,s=1){return s<2?t():Array.from({length:s},()=>t())}e.r(s);var a=function(){return{float:function(t,s,e){return 0===arguments.length?Math.random():1===arguments.length?Math.random()*t:r(()=>h(t,s),e)},int:function(t,s,e){return 1===arguments.length?Math.floor(Math.random()*(t+1)):r(()=>Math.floor(h(t,s+1)),e)},choice:function(t,s){return null==t||0===t.length?null:r(()=>t[Math.floor(Math.random()*t.length)],s)},char:function(t,s){return null==t||0===t.length?null:r(()=>t.charAt(Math.floor(Math.random()*t.length)),s)},shuffle:function(t){let s,e,h=t.length;for(;h;)s=Math.floor(Math.random()*h--),e=t[h],t[h]=t[s],t[s]=e;return t},coin:function(t,s,e=.5,h=1){return r(()=>Math.random()<e?t:s,h)}}}(),i=function(){class t{constructor(t){"number"==typeof t?(this._v=new Array(t).fill(0),this._v[0]=1):Array.isArray(t)?this._v=t:"object"==typeof t&&Array.isArray(t._v)?this._v=t._v:this._v=[1,0,0]}v(){return this._v}i(t,s){if(void 0===s)return this._v[t];this._v[t]=s}f(s){return new t(this._v.map(t=>s(t)))}scale(s){return new t(this._v.map(t=>t*s))}add(s){let e=s.v();return new t(this._v.map((t,s)=>t+e[s]))}dot(t){let s=t.v();return this._v.reduce((t,e,h)=>t+e*s[h],0)}}class s{constructor(t){if("number"==typeof t){this._m=Array.from({length:t},()=>new Array(t).fill(0));for(let s=0;s<t;s++)this._m[s][s]=1}else Array.isArray(t)?this._m=t:"object"==typeof t&&Array.isArray(t._m)?this._m=t._m:this._m=[[1,0,0],[0,1,0],[0,0,1]]}m(){return this._m.map(t=>t.slice())}ij(t,s,e){if(void 0===e)return this._m[t][s];this._m[t][s]=e}f(t){return new s(this._m.map(s=>s.map(s=>t(s))))}scale(t){return this.f(s=>s*t)}add(t){let e=t.m();return new s(this._m.map((t,s)=>t.map((t,h)=>t+e[s][h])))}mult(t){let e=t.m(),h=this._m.length,r=new s(h);for(let t=0;t<h;t++)for(let s=0;s<h;s++){let a=0;for(let r=0;r<h;r++)a+=this._m[t][r]*e[r][s];r.ij(t,s,a)}return r}t(){return new s(this._m[0].map((t,s)=>this._m.map(t=>t[s])))}act(s){return new t(this._m.map(e=>s.dot(new t(e))))}ldl(){let t=this._m.length,e=new s(t),h=new s(t);for(let s=0;s<t;s++){let r=this.ij(s,s);for(let t=0;t<s;t++)r-=e.ij(t,t)*h.ij(s,t)*h.ij(s,t);e.ij(s,s,r);for(let a=t-1;a>s;a--){let t=this.ij(a,s);for(let r=0;r<s;r++)t-=e.ij(r,r)*h.ij(a,r)*h.ij(s,r);h.ij(a,s,t/r)}}return{D:e,L:h}}}return{Vector:t,Matrix:s}}(),n=function(){const t=100,s=1e-10;let e=function(){const t=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];return function s(e){let h=0;if(e<.5)h=Math.PI/(Math.sin(Math.PI*e)*s(1-e));else{e--;let s=.9999999999998099,r=t.length;t.forEach((t,a)=>{s+=t/(e+a+1);let i=e+r-.5;h=Math.sqrt(2*Math.PI)*Math.pow(i,e+.5)*Math.exp(-i)*s})}return h}}(),h=function(){const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];return function(s){let e=s,h=s,r=e+5.5;r=(e+.5)*Math.log(r)-r;let a=1.000000000190015;for(let s=0;s<6;s++)a+=t[s]/++h;return r+Math.log(2.5066282746310007*a/e)}}(),r=function(){const h=1e-30;return function(r,a){return a<r+1?function(e,h){if(h<0)return 0;{let r=e,a=1/e,i=1/e;for(let e=0;e<t&&!((a*=h/++r)<(i+=a)*s);e++);return Math.exp(-h)*Math.pow(h,e)*i}}(r,a):e(r)-function(e,r){let a,i,n=r+1-e,p=1/h,o=1/n,u=o;for(let r=1;r<t&&(o=(a=r*(e-r))*o+(n+=2),Math.abs(o)<h&&(o=h),o=1/o,p=n+a/p,Math.abs(p)<h&&(p=h),u*=i=p*o,!(Math.abs(i-1)<s));r++);return Math.exp(-r)*Math.pow(r,e)*u}(r,a)}}();return{beta:function(t,s){return Math.exp(h(t)+h(s)-h(t+s))},betaIncomplete:function(){const e=1e-30;function r(h,r,a){let i=h+r,n=h+1,p=h-1,o=1,u=1-i*a/n;Math.abs(u)<e&&(u=e);let l=u=1/u;for(let c=1;c<t;c++){let t=2*c,m=c*(r-c)*a/((p+t)*(h+t));u=1+m*u,Math.abs(u)<e&&(u=e),o=1+m/o,Math.abs(o)<e&&(o=e),l*=(u=1/u)*o,u=1+(m=-(h+c)*(i+c)*a/((h+t)*(n+t)))*u,Math.abs(u)<e&&(u=e),o=1+m/o,Math.abs(o)<e&&(o=e);let d=(u=1/u)*o;if(l*=d,Math.abs(d-1)<s)break}return l}return function(t,s,e){let a=e<=0||e>=1?0:Math.exp(h(t+s)-h(t)-h(s)+t*Math.log(e)+s*Math.log(1-e));return e<(t+1)/(t+s+2)?a*r(t,s,e)/t:1-a*r(s,t,1-e)/s}}(),erf:function(){const t=[-1.26551223,1.00002368,.37409196,.09678418,-.18628806,.27886807,-1.13520398,1.48851587,-.82215223,.17087277];return function(s){let e=1/(1+.5*Math.abs(s)),h=1,r=0;t.forEach(t=>{r+=t*h,h*=e});let a=e*Math.exp(r-s*s);return s<0?a-1:1-a}}(),gamma:e,gammaLn:h,gammaLowerIncomplete:r}}();e.d(s,"ts",function(){return o}),e.d(s,"dist",function(){return p}),e.d(s,"mc",function(){return u}),e.d(s,"la",function(){return i}),e.d(s,"core",function(){return a});let p=function(){const t=[0,6.635,9.21,11.345,13.277,15.086,16.812,18.475,20.09,21.666,23.209,24.725,26.217,27.688,29.141,30.578,32,33.409,34.805,36.191,37.566,38.932,40.289,41.638,42.98,44.314,45.642,46.963,48.278,49.588,50.892,52.191,53.486,54.776,56.061,57.342,58.619,59.893,61.162,62.428,63.691,64.95,66.206,67.459,68.71,69.957,71.201,72.443,73.683,74.919,76.154,77.386,78.616,79.843,81.069,82.292,83.513,84.733,85.95,87.166,88.379,89.591,90.802,92.01,93.217,94.422,95.626,96.828,98.028,99.228,100.425,101.621,102.816,104.01,105.202,106.393,107.583,108.771,109.958,111.144,112.329,113.512,114.695,115.876,117.057,118.236,119.414,120.591,121.767,122.942,124.116,125.289,126.462,127.633,128.803,129.973,131.141,132.309,133.476,134.642,135.807,136.971,138.134,139.297,140.459,141.62,142.78,143.94,145.099,146.257,147.414,148.571,149.727,150.882,152.037,153.191,154.344,155.496,156.648,157.8,158.95,160.1,161.25,162.398,163.546,164.694,165.841,166.987,168.133,169.278,170.423,171.567,172.711,173.854,174.996,176.138,177.28,178.421,179.561,180.701,181.84,182.979,184.118,185.256,186.393,187.53,188.666,189.802,190.938,192.073,193.208,194.342,195.476,196.609,197.742,198.874,200.006,201.138,202.269,203.4,204.53,205.66,206.79,207.919,209.047,210.176,211.304,212.431,213.558,214.685,215.812,216.938,218.063,219.189,220.314,221.438,222.563,223.687,224.81,225.933,227.056,228.179,229.301,230.423,231.544,232.665,233.786,234.907,236.027,237.147,238.266,239.386,240.505,241.623,242.742,243.86,244.977,246.095,247.212,248.329,249.445,250.561,251.677,252.793,253.908,255.023,256.138,257.253,258.367,259.481,260.595,261.708,262.821,263.934,265.047,266.159,267.271,268.383,269.495,270.606,271.717,272.828,273.939,275.049,276.159,277.269,278.379,279.488,280.597,281.706,282.814,283.923,285.031,286.139,287.247,288.354,289.461,290.568,291.675,292.782,293.888,294.994,296.1,297.206,298.311,299.417,300.522,301.626,302.731,303.835,304.94],s=[359.906,414.474,468.724,522.717,576.493,630.084,683.516,736.807,789.974,843.029,895.984,948.848,1001.63,1054.334,1106.969];function e(t=0,s=1){let e=Math.random(),h=Math.random();return s*Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*h)+t}function h(t,s){if(!(t>1))return h(t+1,s)*Math.pow(Math.random(),1/t);{let h,r,a,i=t-1/3,n=1/Math.sqrt(9*i);for(;;)if((h=e(0,1))>-1/n&&(r=Math.pow(1+n*h,3),a=Math.random(),Math.log(a)<.5*h*h+i*(1-r+Math.log(r))))return i*r/s}}class a{constructor(t,s){this.type=t,this.k=s,this.p=[],this.c=[]}_generator(){throw Error("Distribution._generator is not implemented")}_pdf(t){throw Error("Distribution._pdf is not implemented")}_cdf(t){throw Error("Distribution._cdf is not implemented")}sample(t){return r(()=>this._generator(),t)}pdf(t){return this._pdf(t)}cdf(t){return this._cdf(t)}survival(t){return 1-this._cdf(t)}hazard(t){return this._pdf(t)/this.survival(t)}cHazard(t){return-Math.log(this.survival(t))}lnPdf(t){return Math.log(this._pdf(t))}L(t){return t.reduce((t,s)=>t+this.lnPdf(s),0)}test(e){return"discrete"===this.type?function(e,h,r){let a={};e.forEach(function(t){a[t]=a[t]?a[t]+1:1});let i=0,n=e.length;for(let t in a)if(a.hasOwnProperty(t)){let s=h(parseInt(t))*n;i+=Math.pow(a[t]-s,2)/s}let p=Math.max(1,Object.keys(a).length-r-1);return{statistics:i,passed:i<=(p<=250?t[p]:s[Math.floor(p/50)])}}(e,t=>this._pdf(t),this.k):function(t,s){t.sort((t,s)=>t-s);let e=0;for(let h=0;h<t.length;h++)e=Math.max(e,Math.abs((h+1)/t.length-s(t[h])));return{statistics:e,passed:e<=1.628/Math.sqrt(t.length)}}(e,t=>this._cdf(t))}}class i extends a{constructor(t=1,s=1){super("continuous",arguments.length),this.p={alpha:t,beta:s},this.c=[Math.pow(s,t),n.gamma(t)]}_generator(){return h(this.p.alpha,this.p.beta)}_pdf(t){return t>0?this.c[0]*Math.exp((this.p.alpha-1)*Math.log(t)-this.p.beta*t)/this.c[1]:0}_cdf(t){return n.gammaLowerIncomplete(this.p.alpha,this.p.beta*t)/this.c[1]}}class p extends a{constructor(t=1,s=1){super("continuous",arguments.length),this.p={lambda:t,mu:s},this.c=[.5*this.p.mu/this.p.lambda,Math.exp(2*t/s)]}static _phi(t){return.5*(1+n.erf(t/Math.SQRT2))}_generator(){let t=e(),s=t*t,h=this.p.mu+this.c[0]*this.p.mu*s-this.c[0]*Math.sqrt(this.p.mu*s*(4*this.p.lambda+this.p.mu*s));return Math.random()>this.p.mu/(this.p.mu+h)?this.p.mu*this.p.mu/h:h}_pdf(t){return t>0?Math.sqrt(this.p.lambda/(2*Math.PI*Math.pow(t,3)))*Math.exp(-this.p.lambda*Math.pow(t-this.p.mu,2)/(2*this.p.mu*this.p.mu*t)):0}_cdf(t){let s=Math.sqrt(this.p.lambda/t),e=t/this.p.mu;return t>0?p._phi(s*(e-1))+this.c[1]*p._phi(-s*(e+1)):0}}class o extends a{constructor(t=1,s=1){super("continuous",arguments.length),this.p={lambda:t,k:s}}_generator(){return this.p.lambda*Math.pow(-Math.log(Math.random()),1/this.p.k)}_pdf(t){return t<0?0:this.p.k/this.p.lambda*Math.exp((this.p.k-1)*Math.log(t/this.p.lambda)-Math.pow(t/this.p.lambda,this.p.k))}_cdf(t){return t<0?0:1-Math.exp(-Math.pow(t/this.p.lambda,this.p.k))}}return{Arcsine:class extends a{constructor(t=0,s=1){super("continuous",arguments.length),this.p={a:t,b:s},this.c=[1/Math.PI,s-t]}_generator(){let t=Math.sin(.5*Math.PI*Math.random());return t*t*this.c[1]+this.p.a}_pdf(t){return t>=this.p.a&&t<this.p.b?this.c[0]/Math.sqrt((t-this.p.a)*(this.p.b-t)):0}_cdf(t){return t>=this.p.a&&t<this.p.b?2*this.c[0]*Math.asin(Math.sqrt((t-this.p.a)/(this.p.b-this.p.a))):0}},Bernoulli:class extends a{constructor(t=.5){super("discrete",arguments.length),this.p={p:t}}_generator(){return Math.random()<this.p.p?1:0}_pdf(t){let s=parseInt(t);return 1===s?this.p.p:0===s?1-this.p.p:0}_cdf(t){return t<0?0:parseInt(t)>=1?1:1-this.p.p}},Beta:class extends a{constructor(t=1,s=1){super("continuous",arguments.length),this.p={alpha:t,beta:s},this.c=[n.beta(t,s)]}_generator(){let t=h(this.p.alpha,1);return t/(t+h(this.p.beta,1))}_pdf(t){return t>0&&t<1?Math.pow(t,this.p.alpha-1)*Math.pow(1-t,this.p.beta-1)/this.c[0]:0}_cdf(t){return t<=0?0:t>=1?1:n.betaIncomplete(this.p.alpha,this.p.beta,t)}},BetaPrime:class extends a{constructor(t=2,s=2){super("continuous",arguments.length),this.p={alpha:t,beta:s}}_generator(){return h(this.p.alpha,1)/h(this.p.beta,1)}_pdf(t){return t>0?Math.pow(t,this.p.alpha-1)*Math.pow(1+t,-this.p.alpha-this.p.beta)/n.beta(this.p.alpha,this.p.beta):0}_cdf(t){return t>0?n.betaIncomplete(this.p.alpha,this.p.beta,t/(1+t)):0}},Binomial:class extends a{constructor(t=100,s=.5){super("continuous",arguments.length);let e=s<=.5?s:1-s;this.p={n:t,p:s},this.c=[e,t*e]}_generator(){if(this.p.n<25){let t=0;for(let s=1;s<=this.p.n;s++)Math.random()<this.c[0]&&t++;return this.c[0]===this.p.p?t:this.p.n-t}if(this.c[1]<1){let t,s=Math.exp(-this.c[1]),e=1;for(t=0;t<=this.p.n&&!((e*=Math.random())<s);t++);let h=Math.min(t,this.p.n);return this.c[0]===this.p.p?h:this.p.n-h}{let t,s,e,h=this.p.n,r=n.gammaLn(h+1),a=1-this.c[0],i=Math.log(this.c[0]),p=Math.log(a),o=Math.sqrt(2*this.c[1]*a);do{do{s=o*(t=Math.tan(Math.PI*Math.random()))+this.c[1]}while(s<0||s>=h+1);s=Math.floor(s),e=1.2*o*(1+t*t)*Math.exp(r-n.gammaLn(s+1)-n.gammaLn(h-s+1)+s*i+(h-s)*p)}while(Math.random()>e);return this.c[0]===this.p.p?s:this.p.n-s}}_pdf(t){let s=parseInt(t);return s<0?0:s>this.p.n?0:Math.exp(n.gammaLn(this.p.n+1)-n.gammaLn(s+1)-n.gammaLn(this.p.n-s+1)+s*Math.log(this.p.p)+(this.p.n-s)*Math.log(1-this.p.p))}_cdf(t){let s=parseInt(t);return s<0?0:s>=this.p.n?1:n.betaIncomplete(this.p.n-s,1+s,1-this.p.p)}},BoundedPareto:class extends a{constructor(t=1,s=10,e=1){super("continuous",arguments.length),this.p={L:t,H:s,alpha:e},this.c=[Math.pow(t,e),Math.pow(s,e),1-Math.pow(t/s,e)]}_generator(){return Math.pow((this.c[1]+Math.random()*(this.c[0]-this.c[1]))/(this.c[0]*this.c[1]),-1/this.p.alpha)}_pdf(t){return t<this.p.L||t>this.p.H?0:this.p.alpha*Math.pow(this.p.L/t,this.p.alpha)/(t*this.c[2])}_cdf(t){return t<this.p.L?0:t>this.p.H?1:(1-this.c[0]*Math.pow(t,-this.p.alpha))/(1-this.c[0]/this.c[1])}},Cauchy:class extends a{constructor(t=0,s=1){super("continuous",arguments.length),this.p={x0:t,gamma:s},this.c=[Math.PI*this.p.gamma]}_generator(){return this.p.x0+this.p.gamma*Math.tan(Math.PI*(Math.random()-.5))}_pdf(t){let s=(t-this.p.x0)/this.p.gamma;return 1/(this.c[0]*(1+s*s))}_cdf(t){return.5+Math.atan2(t-this.p.x0,this.p.gamma)/Math.PI}},Chi2:class extends i{constructor(t=2){super(Math.round(t)/2,.5)}},Custom:class extends a{constructor(t){super("discrete",arguments.length),this.p={n:t.length,weights:t};let s=t.length,e=[0],h=[0],r=0;if(t.length>1){for(let e=0;e<s;e++)r+=t[e];let a=[],i=[],n=[];for(let e=0;e<s;e++)a.push(s*t[e]/r),a[e]<1?i.push(e):n.push(e);e=[],h=[];for(let t=0;t<s;t++)e.push(1),h.push(t);let p=0,o=0;for(;i.length>0&&n.length>0;)p=i.shift(),o=n.shift(),e[p]=a[p],h[p]=o,a[o]+=a[p]-1,a[o]<1?i.push(o):n.push(o);for(;n.length>0;)e[o=n.shift()]=1,h[o]=o;for(;i.length>0;)e[p=i.shift()]=1,h[p]=p}let a=[t[0]/r],i=[t[0]/r];for(let s=1;s<t.length;s++)a.push(t[s]/r),i.push(i[s-1]+t[s]/r);this.c=[e,h,a,i]}_generator(){if(this.p.n<=1)return 0;let t=Math.floor(Math.random()*this.p.n);return Math.random()<this.c[0][t]?t:this.c[1][t]}_pdf(t){if(this.p.n<=1)return 1;{let s=parseInt(t);return s<0||s>=this.p.weights.length?0:this.c[2][s]}}_cdf(t){if(this.p.n<=1)return 1;{let s=parseInt(t);return s<0?0:s>=this.p.weights.length?1:this.c[3][s]}}},Degenerate:class extends a{constructor(t=0){super("continuous",arguments.length),this.p={x0:t}}_generator(){return this.p.x0}_pdf(t){return t===this.p.x0?1:0}_cdf(t){return t<this.p.x0?0:1}},Erlang:class extends i{constructor(t=1,s=1){super(Math.round(t),s)}},Exponential:class extends a{constructor(t=1){super("continuous",arguments.length),this.p={lambda:t}}_generator(){return-Math.log(Math.random())/this.p.lambda}_pdf(t){return this.p.lambda*Math.exp(-this.p.lambda*t)}_cdf(t){return 1-Math.exp(-this.p.lambda*t)}},F:class extends a{constructor(t=2,s=2){super("continuous",arguments.length),this.p={d1:t,d2:s},this.c=[n.beta(t/2,s/2),Math.pow(s,s)]}_generator(){return this.p.d2*h(this.p.d1/2,1)/(this.p.d1*h(this.p.d2/2,1))}_pdf(t){return t>0?Math.sqrt(Math.pow(this.p.d1*t,this.p.d1)*this.c[1]/Math.pow(this.p.d1*t+this.p.d2,this.p.d1+this.p.d2))/(t*this.c[0]):0}_cdf(t){return t>0?n.betaIncomplete(this.p.d1/2,this.p.d2/2,this.p.d1*t/(this.p.d1*t+this.p.d2)):0}},Frechet:class extends a{constructor(t=1,s=1,e=0){super("continuous",arguments.length),this.p={alpha:t,s:s,m:e}}_generator(){return this.p.m+this.p.s*Math.pow(-Math.log(Math.random()),-1/this.p.alpha)}_pdf(t){if(t<=this.p.m)return 0;{let s=(t-this.p.m)/this.p.s;return this.p.alpha*Math.pow(s,-1-this.p.alpha)*Math.exp(-Math.pow(s,-this.p.alpha))/this.p.s}}_cdf(t){return t<=this.p.m?0:Math.exp(-Math.pow((t-this.p.m)/this.p.s,-this.p.alpha))}},Gamma:i,GeneralizedGamma:class extends a{constructor(t=1,s=1,e=1){super("continuous",arguments.length),this.p={a:t,d:s,p:e},this.c=[n.gamma(s/e),e/Math.pow(t,s),1/Math.pow(t,e)]}_generator(){return Math.pow(h(this.p.d/this.p.p,this.c[2]),1/this.p.p)}_pdf(t){return t>0?this.c[1]*Math.exp((this.p.d-1)*Math.log(t)-Math.pow(t/this.p.a,this.p.p))/this.c[0]:0}_cdf(t){return n.gammaLowerIncomplete(this.p.d/this.p.p,Math.pow(t/this.p.a,this.p.p))/this.c[0]}},Gompertz:class extends a{constructor(t=1,s=1){super("continuous",arguments.length),this.p={eta:t,b:s}}_generator(){return Math.log(1-Math.log(Math.random())/this.p.eta)/this.p.b}_pdf(t){return t<0?0:this.p.b*this.p.eta*Math.exp(this.p.eta+this.p.b*t-this.p.eta*Math.exp(this.p.b*t))}_cdf(t){return t<0?0:1-Math.exp(-this.p.eta*(Math.exp(this.p.b*t)-1))}},Gumbel:class extends a{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,beta:s}}_generator(){return this.p.mu-this.p.beta*Math.log(-Math.log(Math.random()))}_pdf(t){let s=(t-this.p.mu)/this.p.beta;return Math.exp(-(s+Math.exp(-s)))/this.p.beta}_cdf(t){return Math.exp(-Math.exp(-(t-this.p.mu)/this.p.beta))}},InverseGamma:class extends a{constructor(t=1,s=1){super("continuous",arguments.length),this.p={alpha:t,beta:s},this.c=[Math.pow(s,t)/n.gamma(t),n.gamma(t)]}_generator(){return 1/h(this.p.alpha,this.p.beta)}_pdf(t){return t>0?this.c[0]*Math.pow(t,-1-this.p.alpha)*Math.exp(-this.p.beta/t):0}_cdf(t){return t>0?1-n.gammaLowerIncomplete(this.p.alpha,this.p.beta/t)/this.c[1]:0}},InverseGaussian:p,Laplace:class extends a{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,b:s}}_generator(){return this.p.b*Math.log(Math.random()/Math.random())+this.p.mu}_pdf(t){return.5*Math.exp(-Math.abs(t-this.p.mu)/this.p.b)/this.p.b}_cdf(t){let s=Math.exp((t-this.p.mu)/this.p.b);return t<this.p.mu?.5*s:1-.5/s}},LogCauchy:class extends a{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,sigma:s}}_generator(){return Math.exp(this.p.mu+this.p.sigma*Math.tan(Math.PI*(Math.random()-.5)))}_pdf(t){return t>0?this.p.sigma/(t*Math.PI*(this.p.sigma*this.p.sigma+Math.pow(Math.log(t)-this.p.mu,2))):0}_cdf(t){return t>0?.5+Math.atan2(Math.log(t)-this.p.mu,this.p.sigma)/Math.PI:0}},Logistic:class extends a{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,s:s}}_generator(){return this.p.mu-this.p.s*Math.log(1/Math.random()-1)}_pdf(t){let s=Math.exp(-(t-this.p.mu)/this.p.s);return s/(this.p.s*Math.pow(1+s,2))}_cdf(t){return 1/(1+Math.exp(-(t-this.p.mu)/this.p.s))}},LogLogistic:class extends a{constructor(t=0,s=1,e=1){super("continuous",arguments.length),this.p={mu:t,sigma:s,xi:e}}_generator(){return this.p.mu+this.p.sigma*(Math.pow(1/Math.random()-1,-this.p.xi)-1)/this.p.xi}_pdf(t){let s=(t-this.p.mu)/this.p.sigma,e=Math.pow(1+this.p.xi*s,-(1/this.p.xi+1))/(this.p.sigma*Math.pow(1+Math.pow(1+this.p.xi*s,-1/this.p.xi),2));return 0===this.p.xi?e:this.p.xi>0?t>=this.p.mu-this.p.sigma/this.p.xi?e:0:t<=this.p.mu-this.p.sigma/this.p.xi?e:0}_cdf(t){let s=(t-this.p.mu)/this.p.sigma,e=1/(1+Math.pow(1+this.p.xi*s,-1/this.p.xi));return 0===this.p.xi?e:this.p.xi>0?t>=this.p.mu-this.p.sigma/this.p.xi?e:0:t<=this.p.mu-this.p.sigma/this.p.xi?e:0}},Lognormal:class extends a{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,sigma:s},this.c=[s*Math.sqrt(2*Math.PI),s*Math.SQRT2]}_generator(){return Math.exp(this.p.mu+this.p.sigma*e(0,1))}_pdf(t){return t>0?Math.exp(-.5*Math.pow((Math.log(t)-this.p.mu)/this.p.sigma,2))/(t*this.c[0]):0}_cdf(t){return t>0?.5*(1+n.erf((Math.log(t)-this.p.mu)/this.c[1])):0}},Lomax:class extends a{constructor(t=1,s=1){super("continuous",arguments.length),this.p={lambda:t,alpha:s}}_generator(){return this.p.lambda*(Math.pow(Math.random(),-1/this.p.alpha)-1)}_pdf(t){return t<0?0:this.p.alpha*Math.pow(1+t/this.p.lambda,-1-this.p.alpha)/this.p.lambda}_cdf(t){return t<0?0:1-Math.pow(1+t/this.p.lambda,-this.p.alpha)}},Minimax:class extends a{constructor(t=1,s=1){super("continuous",arguments.length),this.p={alpha:t,beta:s}}_generator(){return Math.pow(1-Math.pow(1-Math.random(),1/this.p.beta),1/this.p.alpha)}_pdf(t){return t>0&&t<1?this.p.alpha*this.p.beta*Math.pow(t,this.p.alpha-1)*Math.pow(1-Math.pow(t,this.p.alpha),this.p.beta-1):0}_cdf(t){return t>0&&t<1?1-Math.pow(1-Math.pow(t,this.p.alpha),this.p.beta):0}},Normal:class extends a{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,sigma:s},this.c=[s*Math.sqrt(2*Math.PI),s*Math.SQRT2]}_generator(){return e(this.p.mu,this.p.sigma)}_pdf(t){return Math.exp(-.5*Math.pow((t-this.p.mu)/this.p.sigma,2))/this.c[0]}_cdf(t){return.5*(1+n.erf((t-this.p.mu)/this.c[1]))}},Pareto:class extends a{constructor(t=1,s=1){super("continuous",arguments.length),this.p={xmin:t,alpha:s}}_generator(){return this.p.xmin/Math.pow(Math.random(),1/this.p.alpha)}_pdf(t){return t<this.p.xmin?0:this.p.alpha*Math.pow(this.p.xmin/t,this.p.alpha)/t}_cdf(t){return t<this.p.xmin?0:1-Math.pow(this.p.xmin/t,this.p.alpha)}},Poisson:class extends a{constructor(t=1){super("discrete",arguments.length),this.p={lambda:t}}_generator(){if(this.p.lambda<30){let t=Math.exp(-this.p.lambda),s=0,e=1;do{s++,e*=Math.random()}while(e>t);return s-1}{let t=.767-3.36/this.p.lambda,s=Math.PI/Math.sqrt(3*this.p.lambda),e=s*this.p.lambda,h=Math.log(t)-this.p.lambda-Math.log(s);for(;;){let t=Math.random(),r=(e-Math.log((1-t)/t))/s,a=Math.floor(r+.5);if(a<0)continue;let i=Math.random(),p=e-s*r;if(p+Math.log(i/Math.pow(1+Math.exp(p),2))<=h+a*Math.log(this.p.lambda)-n.gammaLn(a+1))return a}}}_pdf(t){let s=parseInt(t);return s<0?0:Math.pow(this.p.lambda,s)*Math.exp(-this.p.lambda)/n.gamma(s+1)}_cdf(t){let s=parseInt(t);return s<0?0:1-n.gammaLowerIncomplete(s+1,this.p.lambda)/n.gamma(s+1)}},Rayleigh:class extends o{constructor(t=1){super(t*Math.SQRT2,2)}},UniformContinuous:class extends a{constructor(t=0,s=1){super("continuous",arguments.length),this.p={xmin:t,xmax:s},this.c=[s-t]}_generator(){return Math.random()*this.c[0]+this.p.xmin}_pdf(t){return t<this.p.xmin||t>this.p.xmax?0:1/this.c[0]}_cdf(t){return t<this.p.xmin?0:t>this.p.xmax?1:(t-this.p.xmin)/this.c[0]}},UniformDiscrete:class extends a{constructor(t=0,s=100){super("discrete",arguments.length),this.p={xmin:t,xmax:s},this.c=[s-t+1]}_generator(){return parseInt(Math.random()*this.c[0])+this.p.xmin}_pdf(t){let s=parseInt(t);return s<this.p.xmin||s>this.p.xmax?0:1/this.c[0]}_cdf(t){let s=parseInt(t);return s<this.p.xmin?0:s>this.p.xmax?1:(1+s-this.p.xmin)/this.c[0]}},Weibull:o,_InvalidDistribution:class extends a{constructor(){super("discrete",arguments.length)}}}}(),o=function(){return{Cov:class{constructor(t=1){this.dim=t,this.n=0,this.x=new Array(this.dim).fill(0),this.xy=Array.from({length:this.dim},()=>new Array(this.dim).fill(0))}reset(){this.n=0,this.x=new Array(this.dim).fill(0),this.xy=Array.from({length:this.dim},()=>new Array(this.dim).fill(0))}update(t){this.x=this.x.map((s,e)=>(this.n*s+t[e])/(this.n+1)),this.xy=this.xy.map((s,e)=>s.map((s,h)=>(this.n*s+t[e]*t[h])/(this.n+1))),this.n++}compute(){return new i.Matrix(this.xy.map((t,s)=>t.map((t,e)=>t-this.x[s]*this.x[e])))}},AC:class{constructor(t=1,s=100,e=1e4){this.dim=t,this.range=s,this.maxSize=e,this.history=Array.from({length:t},()=>[])}_aci(t){let s=t.reduce((t,s)=>t+s)/t.length,e=t.reduce((t,s)=>t+s*s),h=new Array(this.range).fill(0);for(let e=0;e<t.length;e++)for(let r=0;r<h.length;r++)e-r>0&&(h[r]+=(t[e]-s)*(t[e-r]-s));return h.map(function(h){return h/(e-t.length*s*s)})}reset(){this.history=Array.from({length:this.dim},()=>[])}update(t){this.history.forEach((s,e)=>s.push(t[e])),this.history[0].length>=this.maxSize&&this.history.forEach(t=>t.shift())}compute(){return this.history.map(t=>this._aci(t))}}}}(),u=function(){const t=1e4;class s{constructor(s,e={},h={}){this.dim=e.dim||1,this.maxHistory=e.maxHistory||t,this.lnp=s,this.x=h.x||Array.from({length:self.dim},Math.random),this.samplingRate=h.samplingRate||1,this.internal=h.internal||{},this.history=function(t){let s=Array.from({length:t.dim},()=>[]);return{get:()=>s,update(e){s.forEach((t,s)=>t.push(e[s])),s[0].length>=t.maxHistory&&s.forEach(t=>t.shift())}}}(this),this.acceptance=function(t){let s=[];return{compute:()=>_sum(s)/s.length,update(e){s.push(e),s.length>t.maxHistory&&s.shift()}}}(this)}_internal(){throw Error("MCMC._internal() is not implemented")}_iter(t,s=!1){throw Error("MCMC._iter() is not implemented")}_adjust(t){throw Error("MCMC._adjust() is not implemented")}state(){return{x:this.x,samplingRate:this.samplingRate,internals:this._internal()}}statistics(){return this.history.get().map(t=>{let s=t.reduce((t,s)=>t+s,0)/t.length,e=t.reduce((t,e)=>t+(e-s)*(e-s),0)/t.length;return{mean:s,std:e,cv:e/s}})}ar(){return this.acceptance.compute()}ac(){return this.history.get().map(t=>{let s=t.reduce((t,s)=>t+s)/t.length,e=t.reduce((t,s)=>t+s*s),h=new Array(100).fill(0);for(let e=0;e<t.length;e++)for(let r=0;r<h.length;r++)e-r>0&&(h[r]+=(t[e]-s)*(t[e-r]-s));return h.map(function(h){return h/(e-t.length*s*s)})})}iterate(t=null,s=!1){let e=this._iter(this.state.x,s);return this.history.update(e.x),this.acceptance.update(e.accepted),this.x=e.x,t&&t(e.x,e.accepted),e}warmUp(t,s=100){for(let e=0;e<=s;e++){for(let t=0;t<1e4;t++)this._adjust(this.iterate(null,!0));let h=this.ac().reduce((t,s)=>{for(let e=0;e<s.length-1;e++)if(Math.abs(s[e])<=.05)return Math.max(t,e)},0);h>this.samplingRate?this.samplingRate++:h<this.samplingRate&&this.samplingRate>1&&this.samplingRate--,t&&t(100*e/s)}}sample(t,s=1e3){let e=this.samplingRate*s,h=e/100,r=[];for(let s=0;s<e;s++)this.iterate(),s%h==0&&t&&t(s/h),s%this.samplingRate==0&&r.push(this.x);return r}}return{gr:function(){return function(t,s){return t[0][0].map(function(e,h){return new Array(s||1e3).fill(0).map(function(s,e){return function(t,s){let e=[],h=[];t.forEach(function(t){let r=t.map(function(t){return t[s]}),a=_sum(r)/r.length,i=(_sum(r,2)-r.length*a*a)/(r.length-1);e.push(a),h.push(i)});let r=_sum(h)/t.length,a=_sum(e)/t.length,i=(_sum(e,2)-t.length*a*a)*t[0].length/(t.length-1),n=((t[0].length-1)*r+i)/t[0].length;return Math.sqrt(n/r)}(t.map(function(t){return t.slice(0,e+2)}),h)})})}}(),RWM:class extends s{constructor(t,s,e){super(t,s,e),this.lastLnp=this.lnp(this.x),this.proposal=function(t){let s=new p.Normal(0,1),e=new Array(t.dim).fill(0),h=t.internal.proposal||new Array(t.dim).fill(1),r=h.map(t=>Math.log(t)),a=0,i=0,n=0;return{jump:(t,e)=>e?t.map((t,e)=>t+(e===n?s.sample()*h[n]:0)):t.map((t,e)=>t+s.sample()*h[e]),update(s){s&&e[n]++,100==++a&&(e[n]/100>.44?r[n]+=Math.min(.01,Math.pow(i,-.5)):r[n]-=Math.min(.01,Math.pow(i,-.5)),h[n]=Math.exp(r[n]),a=0,e[n]=0,0==(n=(n+1)%t.dim)&&i++)},scales:()=>h.slice()}}(this)}_internal(){return{proposal:this.proposal.scales()}}_iter(t,s){let e=this.proposal.jump(this.x,s),h=this.lnp(e),r=Math.random()<Math.exp(h-this.lastLnp);return r?this.lastLnp=h:e=this.x,{x:e,accepted:r}}_adjust(t){this.proposal.update(t.accepted)}}}}()}]);