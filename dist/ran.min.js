var ran=function(t){var e={};function r(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";function n(t,e=1){return 1!==e?t.reduce((t,r)=>t+Math.pow(r,e),0):t.reduce((t,e)=>t+e,0)}function s(t,e){return t<e?Math.random()*(e-t)+t:Math.random()*(t-e)+e}function h(t,e=1){return e<2?t():Array.from({length:e},()=>t())}r.r(e),r.d(e,"la",function(){return a}),r.d(e,"ts",function(){return l}),r.d(e,"core",function(){return o}),r.d(e,"dist",function(){return p}),r.d(e,"mc",function(){return u});let a=function(){class t{constructor(t){"number"==typeof t?(this._v=new Array(t).fill(0),this._v[0]=1):Array.isArray(t)?this._v=t:"object"==typeof t&&Array.isArray(t._v)?this._v=t._v:this._v=[1,0,0]}v(){return this._v}i(t,e){if(void 0===e)return this._v[t];this._v[t]=e}f(e){return new t(this._v.map(t=>e(t)))}scale(e){return new t(this._v.map(t=>t*e))}add(e){let r=e.v();return new t(this._v.map((t,e)=>t+r[e]))}dot(t){let e=t.v();return this._v.reduce((t,r,n)=>t+r*e[n],0)}}class e{constructor(t){if("number"==typeof t){this._m=Array.from({length:t},()=>new Array(t).fill(0));for(let e=0;e<t;e++)this._m[e][e]=1}else Array.isArray(t)?this._m=t:"object"==typeof t&&Array.isArray(t._m)?this._m=t._m:this._m=[[1,0,0],[0,1,0],[0,0,1]]}m(){return this._m.map(t=>t.slice())}ij(t,e,r){if(void 0===r)return this._m[t][e];this._m[t][e]=r}f(t){return new e(this._m.map(e=>e.map(e=>t(e))))}scale(t){return this.f(e=>e*t)}add(t){let r=t.m();return new e(this._m.map((t,e)=>t.map((t,n)=>t+r[e][n])))}mult(t){let r=t.m(),n=this._m.length,s=new e(n);for(let t=0;t<n;t++)for(let e=0;e<n;e++){let h=0;for(let s=0;s<n;s++)h+=this._m[t][s]*r[s][e];s.ij(t,e,h)}return s}t(){return new e(this._m[0].map((t,e)=>this._m.map(t=>t[e])))}act(e){return new t(this._m.map(r=>e.dot(new t(r))))}ldl(){let t=this._m.length,r=new e(t),n=new e(t);for(let e=0;e<t;e++){let s=this.ij(e,e);for(let t=0;t<e;t++)s-=r.ij(t,t)*n.ij(e,t)*n.ij(e,t);r.ij(e,e,s);for(let h=t-1;h>e;h--){let t=this.ij(h,e);for(let s=0;s<e;s++)t-=r.ij(s,s)*n.ij(h,s)*n.ij(e,s);n.ij(h,e,t/s)}}return{D:r,L:n}}}return{Vector:t,Matrix:e}}(),i=function(){const t=100,e=1e-10;let r=function(){const t=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];return function e(r){let n=0;if(r<.5)n=Math.PI/(Math.sin(Math.PI*r)*e(1-r));else{r--;let e=.9999999999998099,s=t.length;t.forEach((t,h)=>{e+=t/(r+h+1);let a=r+s-.5;n=Math.sqrt(2*Math.PI)*Math.pow(a,r+.5)*Math.exp(-a)*e})}return n}}(),n=function(){const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];return function(e){let r=e,n=e,s=r+5.5;s=(r+.5)*Math.log(s)-s;let h=1.000000000190015;for(let e=0;e<6;e++)h+=t[e]/++n;return s+Math.log(2.5066282746310007*h/r)}}(),s=function(){const n=1e-30;return function(s,h){return h<s+1?function(r,n){if(n<0)return 0;{let s=r,h=1/r,a=1/r;for(let r=0;r<t&&!((h*=n/++s)<(a+=h)*e);r++);return Math.exp(-n)*Math.pow(n,r)*a}}(s,h):r(s)-function(r,s){let h,a,i=s+1-r,o=1/n,p=1/i,l=p;for(let s=1;s<t&&(p=(h=s*(r-s))*p+(i+=2),Math.abs(p)<n&&(p=n),p=1/p,o=i+h/o,Math.abs(o)<n&&(o=n),l*=a=o*p,!(Math.abs(a-1)<e));s++);return Math.exp(-s)*Math.pow(s,r)*l}(s,h)}}(),h=function(){const r=1e-30;function s(n,s,h){let a=n+s,i=n+1,o=n-1,p=1,l=1-a*h/i;Math.abs(l)<r&&(l=r);let u=l=1/l;for(let c=1;c<t;c++){let t=2*c,m=c*(s-c)*h/((o+t)*(n+t));l=1+m*l,Math.abs(l)<r&&(l=r),p=1+m/p,Math.abs(p)<r&&(p=r),u*=(l=1/l)*p,l=1+(m=-(n+c)*(a+c)*h/((n+t)*(i+t)))*l,Math.abs(l)<r&&(l=r),p=1+m/p,Math.abs(p)<r&&(p=r);let f=(l=1/l)*p;if(u*=f,Math.abs(f-1)<e)break}return u}return function(t,e,r){let h=r<=0||r>=1?0:Math.exp(n(t+e)-n(t)-n(e)+t*Math.log(r)+e*Math.log(1-r));return r<(t+1)/(t+e+2)?h*s(t,e,r)/t:1-h*s(e,t,1-r)/e}}(),a=function(){const t=[-1.26551223,1.00002368,.37409196,.09678418,-.18628806,.27886807,-1.13520398,1.48851587,-.82215223,.17087277];return function(e){let r=1/(1+.5*Math.abs(e)),n=1,s=0;t.forEach(t=>{s+=t*n,n*=r});let h=r*Math.exp(s-e*e);return e<0?h-1:1-h}}();return{gamma:r,gammaLn:n,gammaLowerIncomplete:s,betaIncomplete:h,erf:a}}(),o=function(){return{float:function(t,e,r){return 0===arguments.length?s(0,1):1===arguments.length?s(0,t):h(()=>s(t,e),r)},int:function(t,e,r){return 1===arguments.length?Math.floor(s(0,t+1)):h(()=>Math.floor(s(t,e+1)),r)},choice:function(t,e){return null===t||void 0===t||0===t.length?null:h(()=>t[Math.floor(s(0,t.length))],e)},char:function(t,e){return null===t||void 0===t||0===t.length?null:h(()=>t.charAt(Math.floor(s(0,t.length))),e)},shuffle:function(t){let e,r,n=t.length;for(;n;)e=Math.floor(Math.random()*n--),r=t[n],t[n]=t[e],t[e]=r;return t},coin:function(t,e,r,n){let s="number"==typeof r?r:.5;return h(()=>Math.random()<s?t:e,n)}}}(),p=function(){const t=[0,6.635,9.21,11.345,13.277,15.086,16.812,18.475,20.09,21.666,23.209,24.725,26.217,27.688,29.141,30.578,32,33.409,34.805,36.191,37.566,38.932,40.289,41.638,42.98,44.314,45.642,46.963,48.278,49.588,50.892,52.191,53.486,54.776,56.061,57.342,58.619,59.893,61.162,62.428,63.691,64.95,66.206,67.459,68.71,69.957,71.201,72.443,73.683,74.919,76.154,77.386,78.616,79.843,81.069,82.292,83.513,84.733,85.95,87.166,88.379,89.591,90.802,92.01,93.217,94.422,95.626,96.828,98.028,99.228,100.425,101.621,102.816,104.01,105.202,106.393,107.583,108.771,109.958,111.144,112.329,113.512,114.695,115.876,117.057,118.236,119.414,120.591,121.767,122.942,124.116,125.289,126.462,127.633,128.803,129.973,131.141,132.309,133.476,134.642,135.807,136.971,138.134,139.297,140.459,141.62,142.78,143.94,145.099,146.257,147.414,148.571,149.727,150.882,152.037,153.191,154.344,155.496,156.648,157.8,158.95,160.1,161.25,162.398,163.546,164.694,165.841,166.987,168.133,169.278,170.423,171.567,172.711,173.854,174.996,176.138,177.28,178.421,179.561,180.701,181.84,182.979,184.118,185.256,186.393,187.53,188.666,189.802,190.938,192.073,193.208,194.342,195.476,196.609,197.742,198.874,200.006,201.138,202.269,203.4,204.53,205.66,206.79,207.919,209.047,210.176,211.304,212.431,213.558,214.685,215.812,216.938,218.063,219.189,220.314,221.438,222.563,223.687,224.81,225.933,227.056,228.179,229.301,230.423,231.544,232.665,233.786,234.907,236.027,237.147,238.266,239.386,240.505,241.623,242.742,243.86,244.977,246.095,247.212,248.329,249.445,250.561,251.677,252.793,253.908,255.023,256.138,257.253,258.367,259.481,260.595,261.708,262.821,263.934,265.047,266.159,267.271,268.383,269.495,270.606,271.717,272.828,273.939,275.049,276.159,277.269,278.379,279.488,280.597,281.706,282.814,283.923,285.031,286.139,287.247,288.354,289.461,290.568,291.675,292.782,293.888,294.994,296.1,297.206,298.311,299.417,300.522,301.626,302.731,303.835,304.94],e=[359.906,414.474,468.724,522.717,576.493,630.084,683.516,736.807,789.974,843.029,895.984,948.848,1001.63,1054.334,1106.969];function r(t,e){let r=Math.random(),n=Math.random();return e*Math.sqrt(-2*Math.log(r))*Math.cos(2*Math.PI*n)+t}function n(t,e){if(!(t>1))return n(t+1,e)*Math.pow(Math.random(),1/t);{let n,s,h,a=t-1/3,i=1/Math.sqrt(9*a);for(;;)if((n=r(0,1))>-1/i&&(s=Math.pow(1+i*n,3),h=Math.random(),Math.log(h)<.5*n*n+a*(1-s+Math.log(s))))return a*s/e}}class s{constructor(t,e){this.type=t,this.k=e,this.p=[],this.c=[]}_generator(){}_pdf(){}_cdf(){}sample(t){return h(()=>this._generator(),t)}pdf(t){return this._pdf(t)}cdf(t){return this._cdf(t)}survival(t){return 1-this._cdf(t)}hazard(t){return this._pdf(t)/this.survival(t)}cHazard(t){return-Math.log(this.survival(t))}lnPdf(t){return Math.log(this._pdf(t))}L(t){return t.reduce((t,e)=>t+this.lnPdf(e),0)}test(r){return"discrete"===this.type?function(r,n,s){let h={};r.forEach(function(t){h[t]=h[t]?h[t]+1:1});let a=0,i=r.length;for(let t in h){let e=n(parseInt(t))*i;a+=Math.pow(h[t]-e,2)/e}let o=Math.max(1,Object.keys(h).length-s-1);return{statistics:a,passed:a<=(o<=250?t[o]:e[Math.floor(o/50)])}}(r,t=>this._pdf(t),this.k):function(t,e){t.sort((t,e)=>t-e);let r=0;for(let n=0;n<t.length;n++)r=Math.max(r,Math.abs((n+1)/t.length-e(t[n])));return{statistics:r,passed:r<=1.628/Math.sqrt(t.length)}}(r,t=>this._cdf(t))}}class a extends s{constructor(t,e){super("continuous",arguments.length),this.p={alpha:t,beta:e},this.c=[Math.pow(e,t),i.gamma(t)]}_generator(){return n(this.p.alpha,this.p.beta)}_pdf(t){return t<=0?0:this.c[0]*Math.exp((this.p.alpha-1)*Math.log(t)-this.p.beta*t)/this.c[1]}_cdf(t){return i.gammaLowerIncomplete(this.p.alpha,this.p.beta*t)/this.c[1]}}return{Bernoulli:class extends s{constructor(t){super("discrete",arguments.length),this.p={p:t}}_generator(){return Math.random()<this.p.p?1:0}_pdf(t){return 1===parseInt(t)?this.p.p:1-this.p.p}_cdf(t){return t<0?0:parseInt(t)>=1?1:1-this.p.p}},Beta:class extends s{constructor(t,e){super("continuous",arguments.length),this.p={alpha:t,beta:e},this.c=[Math.exp(i.gammaLn(t)+i.gammaLn(e)-i.gammaLn(t+e))]}_generator(){let t=n(this.p.alpha,1);return t/(t+n(this.p.beta,1))}_pdf(t){return Math.pow(t,this.p.alpha-1)*Math.pow(1-t,this.p.beta-1)/this.c[0]}_cdf(t){return t<=0?0:t>=1?1:i.betaIncomplete(this.p.alpha,this.p.beta,t)}},Binomial:class extends s{constructor(t,e){super("continuous",arguments.length);let r=e<=.5?e:1-e;this.p={n:t,p:e},this.c=[r,t*r]}_generator(){if(this.p.n<25){let t=0;for(let e=1;e<=this.p.n;e++)Math.random()<this.c[0]&&t++;return this.c[0]===this.p.p?t:this.p.n-t}if(this.c[1]<1){let t=Math.exp(-this.c[1]),e=1,r=0;for(r=0;r<=this.p.n&&!((e*=Math.random())<t);r++);let n=r<=this.p.n?r:this.p.n;return this.c[0]===this.p.p?n:this.p.n-n}{let t,e,r,n=this.p.n,s=i.gammaLn(n+1),h=1-this.c[0],a=Math.log(this.c[0]),o=Math.log(h),p=Math.sqrt(2*this.c[1]*h);do{do{e=p*(t=Math.tan(Math.PI*Math.random()))+this.c[1]}while(e<0||e>=n+1);e=Math.floor(e),r=1.2*p*(1+t*t)*Math.exp(s-i.gammaLn(e+1)-i.gammaLn(n-e+1)+e*a+(n-e)*o)}while(Math.random()>r);return this.c[0]===this.p.p?e:this.p.n-e}}_pdf(t){let e=parseInt(t);return e<0?0:e>this.p.n?0:Math.exp(i.gammaLn(this.p.n+1)-i.gammaLn(e+1)-i.gammaLn(this.p.n-e+1)+e*Math.log(this.p.p)+(this.p.n-e)*Math.log(1-this.p.p))}_cdf(t){let e=parseInt(t);return e<=0?0:e>this.p.n?1:i.betaIncomplete(this.p.n-e,1+e,1-this.p.p)}},BoundedPareto:class extends s{constructor(t,e,r){super("continuous",arguments.length),this.p={xmin:t,xmax:e,alpha:r},this.c=[Math.pow(t,r),Math.pow(e,r),1-Math.pow(t/e,r)]}_generator(){return Math.pow((this.c[1]+Math.random()*(this.c[0]-this.c[1]))/(this.c[0]*this.c[1]),-1/this.p.alpha)}_pdf(t){return t<this.p.xmin||t>this.p.xmax?0:this.p.alpha*Math.pow(this.p.xmin/t,this.p.alpha)/(t*this.c[2])}_cdf(t){return t<this.p.xmin?0:t>this.p.xmax?1:(1-this.c[0]*Math.pow(t,-this.p.alpha))/(1-this.c[0]/this.c[1])}},Chi2:class extends a{constructor(t){super(Math.round(t)/2,.5)}},Custom:class extends s{constructor(t){super("discrete",arguments.length),this.p={n:t.length,weights:t};let e=t.length,r=[0],n=[0],s=0;if(t.length>1){for(let r=0;r<e;r++)s+=t[r];let h=[],a=[],i=[];for(let r=0;r<e;r++)h.push(e*t[r]/s),h[r]<1?a.push(r):i.push(r);r=[],n=[];for(let t=0;t<e;t++)r.push(1),n.push(t);let o=0,p=0;for(;a.length>0&&i.length>0;)o=a.shift(),p=i.shift(),r[o]=h[o],n[o]=p,h[p]+=h[o]-1,h[p]<1?a.push(p):i.push(p);for(;i.length>0;)r[p=i.shift()]=1,n[p]=p;for(;a.length>0;)r[o=a.shift()]=1,n[o]=o}let h=[t[0]/s],a=[t[0]/s];for(let e=1;e<t.length;e++)h.push(t[e]/s),a.push(a[e-1]+t[e]/s);this.c=[r,n,h,a]}_generator(){if(this.p.n<=1)return 0;let t=Math.floor(Math.random()*this.p.n);return Math.random()<this.c[0][t]?t:this.c[1][t]}_pdf(t){let e=parseInt(t);return e<0||e>=this.p.weights.length?0:this.c[2][e]}_cdf(t){let e=parseInt(t);return e<0?0:e>=this.p.weights.length?1:this.c[3][e]}},Degenerate:class extends s{constructor(t){super("continuous",arguments.length),this.p={x0:t}}_generator(){return this.p.x0}_pdf(t){return t===this.p.x0?1:0}_cdf(t){return t<this.p.x0?0:t>this.p.x0?1:.5}},Erlang:class extends a{constructor(t,e){super(Math.round(t),e)}},Exponential:class extends s{constructor(t){super("continuous",arguments.length),this.p={lambda:t}}_generator(){return-Math.log(Math.random())/this.p.lambda}_pdf(t){return this.p.lambda*Math.exp(-this.p.lambda*t)}_cdf(t){return 1-Math.exp(-this.p.lambda*t)}},Gamma:a,GeneralizedGamma:class extends s{constructor(t,e,r){super("continuous",arguments.length),this.p={a:t,d:e,p:r},this.c=[i.gamma(e/r),r/Math.pow(t,e),1/Math.pow(t,r)]}_generator(){return Math.pow(n(this.p.d/this.p.p,this.c[2]),1/this.p.p)}_pdf(t){return t<=0?0:this.c[1]*Math.exp((this.p.d-1)*Math.log(t)-Math.pow(t/this.p.a,this.p.p))/this.c[0]}_cdf(t){return i.gammaLowerIncomplete(this.p.d/this.p.p,Math.pow(t/this.p.a,this.p.p))/this.c[0]}},InverseGamma:class extends s{constructor(t,e){super("continuous",arguments.length),this.p={alpha:t,beta:e},this.c=[Math.pow(e,t)/i.gamma(t),i.gamma(t)]}_generator(){return 1/n(this.p.alpha,this.p.beta)}_pdf(t){return t<=0?0:this.c[0]*Math.pow(t,-1-this.p.alpha)*Math.exp(-this.p.beta/t)}_cdf(t){return 1-i.gammaLowerIncomplete(this.p.alpha,this.p.beta/t)/this.c[1]}},Lognormal:class extends s{constructor(t,e){super("continuous",arguments.length),this.p={mu:t,sigma:e},this.c=[e*Math.sqrt(2*Math.PI),e*Math.SQRT2]}_generator(){return Math.exp(this.p.mu+this.p.sigma*r(0,1))}_pdf(t){return t<=0?0:Math.exp(-.5*Math.pow((Math.log(t)-this.p.mu)/this.p.sigma,2))/(t*this.c[0])}_cdf(t){return t<=0?0:.5*(1+i.erf((Math.log(t)-this.p.mu)/this.c[1]))}},Normal:class extends s{constructor(t,e){super("continuous",arguments.length),this.p={mu:t,sigma:e},this.c=[e*Math.sqrt(2*Math.PI),e*Math.SQRT2]}_generator(){return r(this.p.mu,this.p.sigma)}_pdf(t){return Math.exp(-.5*Math.pow((t-this.p.mu)/this.p.sigma,2))/this.c[0]}_cdf(t){return.5*(1+i.erf((t-this.p.mu)/this.c[1]))}},Pareto:class extends s{constructor(t,e){super("continuous",arguments.length),this.p={xmin:t,alpha:e}}_generator(){return this.p.xmin/Math.pow(Math.random(),1/this.p.alpha)}_pdf(t){return t<this.p.xmin?0:this.p.alpha*Math.pow(this.p.xmin/t,this.p.alpha)/t}_cdf(t){return t<this.p.xmin?0:1-Math.pow(this.p.xmin/t,this.p.alpha)}},Poisson:class extends s{constructor(t){super("discrete",arguments.length),this.p={lambda:t}}_generator(){if(this.p.lambda<30){let t=Math.exp(-this.p.lambda),e=0,r=1;do{e++,r*=Math.random()}while(r>t);return e-1}{let t=.767-3.36/this.p.lambda,e=Math.PI/Math.sqrt(3*this.p.lambda),r=e*this.p.lambda,n=Math.log(t)-this.p.lambda-Math.log(e);for(;;){let t=Math.random(),s=(r-Math.log((1-t)/t))/e,h=Math.floor(s+.5);if(h<0)continue;let a=Math.random(),o=r-e*s;if(o+Math.log(a/Math.pow(1+Math.exp(o),2))<=n+h*Math.log(this.p.lambda)-i.gammaLn(h+1))return h}}}_pdf(t){let e=parseInt(t);return e<0?0:Math.pow(this.p.lambda,e)*Math.exp(-this.p.lambda)/i.gamma(e+1)}_cdf(t){let e=parseInt(t);return e<0?0:1-i.gammaLowerIncomplete(e+1,this.p.lambda)/i.gamma(e+1)}},UniformContinuous:class extends s{constructor(t,e){super("continuous",arguments.length),this.p={xmin:t,xmax:e},this.c=[e-t]}_generator(){return Math.random()*this.c[0]+this.p.xmin}_pdf(t){return t<this.p.xmin||t>this.p.xmax?0:1/this.c[0]}_cdf(t){return t<this.p.xmin?0:t>this.p.xmax?1:(t-this.p.xmin)/this.c[0]}},UniformDiscrete:class extends s{constructor(t,e){super("discrete",arguments.length),this.p={xmin:t,xmax:e},this.c=[e-t+1]}_generator(){return parseInt(Math.random()*this.c[0])+this.p.xmin}_pdf(t){let e=parseInt(t);return e<this.p.xmin||e>this.p.xmax?0:1/this.c[0]}_cdf(t){let e=parseInt(t);return e<this.p.xmin?0:e>this.p.xmax?1:(1+e-this.p.xmin)/this.c[0]}},Weibull:class extends s{constructor(t,e){super("continuous",arguments.length),this.p={lambda:t,k:e}}_generator(){return this.p.lambda*Math.pow(-Math.log(Math.random()),1/this.p.k)}_pdf(t){return t<0?0:this.p.k/this.p.lambda*Math.exp((this.p.k-1)*Math.log(t/this.p.lambda)-Math.pow(t/this.p.lambda,this.p.k))}_cdf(t){return t<0?0:1-Math.exp(-Math.pow(t/this.p.lambda,this.p.k))}}}}(),l=function(){return{Cov:class{constructor(t=1){this.dim=t,this.n=0,this.x=new Array(this.dim).fill(0),this.xy=Array.from({length:this.dim},()=>new Array(this.dim).fill(0))}reset(){this.n=0,this.x=new Array(this.dim).fill(0),this.xy=Array.from({length:this.dim},()=>new Array(this.dim).fill(0))}update(t){this.x=this.x.map((e,r)=>(this.n*e+t[r])/(this.n+1)),this.xy=this.xy.map((e,r)=>e.map((e,n)=>(this.n*e+t[r]*t[n])/(this.n+1))),this.n++}compute(){return new a.Matrix(this.xy.map((t,e)=>t.map((t,r)=>t-this.x[e]*this.x[r])))}},AC:class{constructor(t=1,e=100,r=1e4){this.dim=t,this.range=e,this.maxSize=r,this.history=Array.from({length:t},()=>[])}_aci(t){let e=t.reduce((t,e)=>t+e)/t.length,r=t.reduce((t,e)=>t+e*e),n=new Array(this.range).fill(0);for(let r=0;r<t.length;r++)for(let s=0;s<n.length;s++)r-s>0&&(n[s]+=(t[r]-e)*(t[r-s]-e));return n.map(function(n){return n/(r-t.length*e*e)})}reset(){this.history=Array.from({length:this.dim},()=>[])}update(t){this.history.forEach((e,r)=>e.push(t[r])),this.history[0].length>=this.maxSize&&this.history.forEach(t=>t.shift())}compute(){return this.history.map(t=>this._aci(t))}}}}(),u=function(){const t=1e4;let e=function(){return function(t,e){return t[0][0].map(function(r,s){return new Array(e||1e3).fill(0).map(function(e,r){return function(t,e){let r=[],s=[];t.forEach(function(t){let h=t.map(function(t){return t[e]}),a=n(h)/h.length,i=(n(h,2)-h.length*a*a)/(h.length-1);r.push(a),s.push(i)});let h=n(s)/t.length,a=n(r)/t.length,i=(n(r,2)-t.length*a*a)*t[0].length/(t.length-1),o=((t[0].length-1)*h+i)/t[0].length;return Math.sqrt(o/h)}(t.map(function(t){return t.slice(0,r+2)}),s)})})}}();class r{constructor(e,r={},s={}){this.dim=r.dim||1,this.maxHistory=r.maxHistory||t,this.lnp=e,this.x=s.x||Array.from({length:self.dim},Math.random),this.samplingRate=s.samplingRate||1,this.internal=s.internal||{},this.history=function(t){let e=Array.from({length:t.dim},()=>[]);return{get:()=>e,update(r){e.forEach((t,e)=>t.push(r[e])),e[0].length>=t.maxHistory&&e.forEach(t=>t.shift())}}}(this),this.acceptance=function(t){let e=[];return{compute:()=>n(e)/e.length,update(r){e.push(r),e.length>t.maxHistory&&e.shift()}}}(this)}_internal(){throw Error("MCMC._internal() is not implemented")}_iter(t,e=!1){throw Error("MCMC._iter() is not implemented")}_adjust(t){throw Error("MCMC._adjust() is not implemented")}state(){return{x:this.x,samplingRate:this.samplingRate,internals:this._internal()}}statistics(){return this.history.get().map(t=>{let e=t.reduce((t,e)=>t+e,0)/t.length,r=t.reduce((t,r)=>t+(r-e)*(r-e),0)/t.length;return{mean:e,std:r,cv:r/e}})}ar(){return this.acceptance.compute()}ac(){return this.history.get().map(t=>{let e=t.reduce((t,e)=>t+e)/t.length,r=t.reduce((t,e)=>t+e*e),n=new Array(100).fill(0);for(let r=0;r<t.length;r++)for(let s=0;s<n.length;s++)r-s>0&&(n[s]+=(t[r]-e)*(t[r-s]-e));return n.map(function(n){return n/(r-t.length*e*e)})})}iterate(t=null,e=!1){let r=this._iter(this.state.x,e);return this.history.update(r.x),this.acceptance.update(r.accepted),this.x=r.x,t&&t(r.x,r.accepted),r}warmUp(t,e=100){for(let r=0;r<=e;r++){for(let t=0;t<1e4;t++)this._adjust(this.iterate(null,!0));let n=this.ac().reduce((t,e)=>{for(let r=0;r<e.length-1;r++)if(Math.abs(e[r])<=.05)return Math.max(t,r)},0);n>this.samplingRate?this.samplingRate++:n<this.samplingRate&&this.samplingRate>1&&this.samplingRate--,t&&t(100*r/e)}}sample(t,e=1e3){let r=this.samplingRate*e,n=r/100,s=[];for(let e=0;e<r;e++)this.iterate(),e%n==0&&t&&t(e/n),e%this.samplingRate==0&&s.push(this.x);return s}}return{gr:e,RWM:class extends r{constructor(t,e,r){super(t,e,r),this.lastLnp=this.lnp(this.x),this.proposal=function(t){let e=new p.Normal(0,1),r=new Array(t.dim).fill(0),n=t.internal.proposal||new Array(t.dim).fill(1),s=n.map(t=>Math.log(t)),h=0,a=0,i=0;return{jump:(t,r)=>r?t.map((t,r)=>t+(r===i?e.sample()*n[i]:0)):t.map((t,r)=>t+e.sample()*n[r]),update(e){e&&r[i]++,100==++h&&(r[i]/100>.44?s[i]+=Math.min(.01,Math.pow(a,-.5)):s[i]-=Math.min(.01,Math.pow(a,-.5)),n[i]=Math.exp(s[i]),h=0,r[i]=0,0==(i=(i+1)%t.dim)&&a++)},scales:()=>n.slice()}}(this)}_internal(){return{proposal:this.proposal.scales()}}_iter(t,e){let r=this.proposal.jump(this.x,e),n=this.lnp(r),s=Math.random()<Math.exp(n-this.lastLnp);return s?this.lastLnp=n:r=this.x,{x:r,accepted:s}}_adjust(t){this.proposal.update(t.accepted)}}}}()}]);