(function(t,n){if(typeof exports==="object"&&typeof module!=="undefined"){n(exports)}else if(typeof define==="function"&&define["amd"]){define(["exports"],n)}else{n(t.ran=t["ran"]||{})}})(this,function(t){"use strict";function n(t,n=1){if(n!==1){return t.reduce((t,i)=>{return t+Math.pow(i,n)},0)}else{return t.reduce((t,n)=>{return t+n},0)}}function i(t,n){return t<n?Math.random()*(n-t)+t:Math.random()*(t-n)+n}function h(t,n=1){if(n<2)return t();else{return Array.from({length:n},()=>t())}}let e=function(){class t{constructor(t){if(typeof t==="number"){this._v=new Array(t).fill(0);this._v[0]=1}else if(Array.isArray(t)){this._v=t}else if(typeof t==="object"&&Array.isArray(t.v)){this._v=t.v}else{this._v=[1,0,0]}}v(){return this._v}mult(n){return new t(this._v.map(t=>t*n))}add(n){let i=n.v();return new t(this._v.map((t,n)=>t+i[n]))}dot(t){let n=t.v();return this._v.reduce((t,i,h)=>t+i*n[h],0)}}class n{constructor(t){if(typeof t==="number"){this._m=Array.from({length:t},()=>new Array(t).fill(0));for(let n=0;n<t;n++){this._m[n][n]=1}}else if(Array.isArray(t)){this._m=t}else if(typeof t==="object"&&Array.isArray(t.m)){this._m=t.m}else{this._m=[[1,0,0],[0,1,0],[0,0,1]]}}m(){return this._m.map(t=>t.slice())}ij(t,n,i){if(i!==undefined){this._m[t][n]=i}else{return this._m[t][n]}}t(){let t=this._m.length,i=new n(t);for(let n=0;n<t;n++){for(let h=0;h<t;h++){i.ij(n,h,this._m[h][n])}}return i}f(t){return new n(this._m.map(n=>n.map(n=>t(n))))}scale(t){return this.f(n=>n*t)}add(t){let i=t.m();return new n(this._m.map((t,n)=>t.map((t,h)=>t+i[n][h])))}mult(t){let i=t.m();let h=this._m.length;let e=new n(h);for(let t=0;t<h;t++){for(let n=0;n<h;n++){let r=0;for(let e=0;e<h;e++){r+=this.ij(t,e)*i[e][n]}e.ij(t,n,r)}}return e}act(n){return new t(this._m.map(i=>n.dot(new t(i))))}ldl(){let t=this._m.length,i=new n(t),h=new n(t);for(let n=0;n<t;n++){let e=this.ij(n,n);for(let t=0;t<n;t++){e-=i.ij(t,t)*h.ij(n,t)*h.ij(n,t)}i.ij(n,n,e);for(let r=t-1;r>n;r--){let t=this.ij(r,n);for(let e=0;e<n;e++){t-=i.ij(e,e)*h.ij(r,e)*h.ij(n,e)}h.ij(r,n,t/e)}}return{D:i,L:h}}}return{Vector:t,Matrix:n}}();let r=function(){const t=100;const n=1e-10;let i=function(){const t=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];function n(i){let h=0;if(i<.5){h=Math.PI/(Math.sin(Math.PI*i)*n(1-i))}else{i--;let n=.9999999999998099,e=t.length;t.forEach((t,r)=>{n+=t/(i+r+1);let a=i+e-.5;h=Math.sqrt(2*Math.PI)*Math.pow(a,i+.5)*Math.exp(-a)*n})}return h}return n}();let h=function(){const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];return function(n){let i=n,h=n,e=i+5.5;e=(i+.5)*Math.log(e)-e;let r=1.000000000190015;for(let n=0;n<6;n++){h++;r+=t[n]/h}return e+Math.log(2.5066282746310007*r/i)}}();let e=function(){const h=1e-30;function e(i,h){if(h<0){return 0}else{let e=i,r=1/i,a=1/i;for(let i=0;i<t;i++){e++;r*=h/e;a+=r;if(r<a*n)break}return Math.exp(-h)*Math.pow(h,i)*a}}function r(i,e){let r=e+1-i,a=1/h,s=1/r,o=s,u,f;for(let e=1;e<t;e++){u=e*(i-e);r+=2;s=u*s+r;if(Math.abs(s)<h)s=h;s=1/s;a=r+u/a;if(Math.abs(a)<h)a=h;f=a*s;o*=f;if(Math.abs(f-1)<n)break}return Math.exp(-e)*Math.pow(e,i)*o}return function(t,n){return n<t+1?e(t,n):i(t)-r(t,n)}}();let r=function(){const i=1e-30;function e(h,e,r){let a=h+e,s=h+1,o=h-1,u=1,f=1-a*r/s;if(Math.abs(f)<i)f=i;f=1/f;let p=f;for(let c=1;c<t;c++){let t=2*c,l=c*(e-c)*r/((o+t)*(h+t));f=1+l*f;if(Math.abs(f)<i)f=i;u=1+l/u;if(Math.abs(u)<i)u=i;f=1/f;p*=f*u;l=-(h+c)*(a+c)*r/((h+t)*(s+t));f=1+l*f;if(Math.abs(f)<i)f=i;u=1+l/u;if(Math.abs(u)<i)u=i;f=1/f;let m=f*u;p*=m;if(Math.abs(m-1)<n)break}return p}return function(t,n,i){let r=i<=0||i>=1?0:Math.exp(h(t+n)-h(t)-h(n)+t*Math.log(i)+n*Math.log(1-i));return i<(t+1)/(t+n+2)?r*e(t,n,i)/t:1-r*e(n,t,1-i)/n}}();let a=function(){const t=[-1.26551223,1.00002368,.37409196,.09678418,-.18628806,.27886807,-1.13520398,1.48851587,-.82215223,.17087277];return function(n){let i=1/(1+.5*Math.abs(n)),h=1,e=0;t.forEach(t=>{e+=t*h;h*=i});let r=i*Math.exp(e-n*n);return n<0?r-1:1-r}}();return{gamma:i,gammaLn:h,gammaLowerIncomplete:e,betaIncomplete:r,erf:a}}();let a=function(){function t(t,n,e){if(arguments.length===0)return i(0,1);if(arguments.length===1)return i(0,t);return h(()=>i(t,n),e)}function n(t,n,e){if(arguments.length===1)return Math.floor(i(0,t+1));return h(()=>Math.floor(i(t,n+1)),e)}function e(t,n){if(t===null||t===undefined||t.length===0)return null;return h(()=>t[Math.floor(i(0,t.length))],n)}function r(t,n){if(t===null||t===undefined||t.length===0)return null;return h(()=>t.charAt(Math.floor(i(0,t.length))),n)}function a(t){let n,i,h=t.length;while(h){n=Math.floor(Math.random()*h--);i=t[h];t[h]=t[n];t[n]=i}return t}function s(t,n,i,e){let r=typeof i==="number"?i:.5;return h(()=>Math.random()<r?t:n,e)}return{float:t,int:n,choice:e,char:r,shuffle:a,coin:s}}();let s=function(){const t=[0,7.879,10.597,12.838,14.86,16.75,18.548,20.278,21.955,23.589,25.188,26.757,28.3,29.819,31.319,32.801,34.267,35.718,37.156,38.582,39.997,41.401,42.796,44.181,45.559,46.928,48.29,49.645,50.993,52.336,53.672,55.003,56.328,57.648,58.964,60.275,61.581,62.883,64.181,65.476,66.766,68.053,69.336,70.616,71.893,73.166,74.437,75.704,76.969,78.231,79.49,80.747,82.001,83.253,84.502,85.749,86.994,88.236,89.477,90.715,91.952,93.186,94.419,95.649,96.878,98.105,99.33,100.554,101.776,102.996,104.215,105.432,106.648,107.862,109.074,110.286,111.495,112.704,113.911,115.117,116.321,117.524,118.726,119.927,121.126,122.325,123.522,124.718,125.913,127.106,128.299,129.491,130.681,131.871,133.059,134.247,135.433,136.619,137.803,138.987,140.169,141.351,142.532,143.712,144.891,146.07,147.247,148.424,149.599,150.774,151.948,153.122,154.294,155.466,156.637,157.808,158.977,160.146,161.314,162.481,163.648,164.814,165.98,167.144,168.308,169.471,170.634,171.796,172.957,174.118,175.278,176.438,177.597,178.755,179.913,181.07,182.226,183.382,184.538,185.693,186.847,188.001,189.154,190.306,191.458,192.61,193.761,194.912,196.062,197.211,198.36,199.509,200.657,201.804,202.951,204.098,205.244,206.39,207.535,208.68,209.824,210.968,212.111,213.254,214.396,215.539,216.68,217.821,218.962,220.102,221.242,222.382,223.521,224.66,225.798,226.936,228.074,229.211,230.347,231.484,232.62,233.755,234.891,236.026,237.16,238.294,239.428,240.561,241.694,242.827,243.959,245.091,246.223,247.354,248.485,249.616,250.746,251.876,253.006,254.135,255.264,256.393,257.521,258.649,259.777,260.904,262.031,263.158,264.285,265.411,266.537,267.662,268.788,269.912,271.037,272.162,273.286,274.409,275.533,276.656,277.779,278.902,280.024,281.146,282.268,283.39,284.511,285.632,286.753,287.874,288.994,290.114,291.234,292.353,293.472,294.591,295.71,296.828,297.947,299.065,300.182,301.3,302.417,303.534,304.651,305.767,306.883,307.999,309.115,310.231,311.346];const n=[366.844,421.9,476.606,531.026,585.207,639.183,692.982,746.625,800.131,853.514,906.786,959.957,1013.036,1066.031,1118.948];function i(t,n){let i=Math.random(),h=Math.random();return n*Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*h)+t}function e(t,n){if(t>1){let h=t-1/3,e=1/Math.sqrt(9*h),r,a,s;while(true){r=i(0,1);if(r>-1/e){a=Math.pow(1+e*r,3);s=Math.random();if(Math.log(s)<.5*r*r+h*(1-a+Math.log(a)))return h*a/n}}}else{return e(t+1,n)*Math.pow(Math.random(),1/t)}}function a(i,h,e){let r={};i.forEach(function(t){r[t]=r[t]?r[t]+1:1});let a=0,s=i.length;for(let t in r){let n=h(parseInt(t))*s;a+=Math.pow(r[t]-n,2)/n}let o=Math.max(1,Object.keys(r).length-e-1),u=o<=250?t[o]:n[Math.floor(o/50)];return{statistics:a,passed:a<=u}}function s(t,n){t.sort((t,n)=>t-n);let i=0;for(let h=0;h<t.length;h++){i=Math.max(i,Math.abs((h+1)/t.length-n(t[h])))}return{statistics:i,passed:i<=1.628/Math.sqrt(t.length)}}class o{constructor(t,n){this.type=t;this.k=n;this.p=[];this.c=[]}_generator(){}sample(t){return h(()=>this._generator(),t)}pdf(t){}cdf(t){}survival(t){return 1-this.cdf(t)}hazard(t){return this.pdf(t)/this.survival(t)}cHazard(t){return-Math.log(this.survival(t))}lnPdf(t){return Math.log(this.pdf(t))}L(t){return t.reduce((t,n)=>t+Math.log(this.pdf(n)),0)}test(t){return this.type==="discrete"?a(t,t=>this.pdf(t),this.k):s(t,t=>this.cdf(t))}}class u extends o{constructor(t){super("discrete",arguments.length);this.p={p:t}}_generator(){return Math.random()<this.p.p?1:0}pdf(t){return parseInt(t)===1?this.p.p:1-this.p.p}cdf(t){return t<0?0:parseInt(t)>=1?1:1-this.p.p}}class f extends o{constructor(t,n){super("continuous",arguments.length);this.p={alpha:t,beta:n};this.c=[Math.exp(r.gammaLn(t)+r.gammaLn(n)-r.gammaLn(t+n))]}_generator(){let t=e(this.p.alpha,1),n=e(this.p.beta,1);return t/(t+n)}pdf(t){return Math.pow(t,this.p.alpha-1)*Math.pow(1-t,this.p.beta-1)/this.c[0]}cdf(t){return t<=0?0:t>=1?1:r.betaIncomplete(this.p.alpha,this.p.beta,t)}}class p extends o{constructor(t,n){super("continuous",arguments.length);let i=n<=.5?n:1-n;this.p={n:t,p:n};this.c=[i,t*i]}_generator(){if(this.p.n<25){let t=0;for(let n=1;n<=this.p.n;n++)if(Math.random()<this.c[0])t++;return this.c[0]===this.p.p?t:this.p.n-t}else if(this.c[1]<1){let t=Math.exp(-this.c[1]),n=1,i=0;for(i=0;i<=this.p.n;i++){n*=Math.random();if(n<t)break}let h=i<=this.p.n?i:this.p.n;return this.c[0]===this.p.p?h:this.p.n-h}else{let t=this.p.n,n=r.gammaLn(t+1),i=1-this.c[0],h=Math.log(this.c[0]),e=Math.log(i),a=Math.sqrt(2*this.c[1]*i);let s,o,u;do{do{s=Math.tan(Math.PI*Math.random());o=a*s+this.c[1]}while(o<0||o>=t+1)o=Math.floor(o);u=1.2*a*(1+s*s)*Math.exp(n-r.gammaLn(o+1)-r.gammaLn(t-o+1)+o*h+(t-o)*e)}while(Math.random()>u)return this.c[0]===this.p.p?o:this.p.n-o}}pdf(t){let n=parseInt(t);return n<0?0:n>this.p.n?0:Math.exp(r.gammaLn(this.p.n+1)-r.gammaLn(n+1)-r.gammaLn(this.p.n-n+1)+n*Math.log(this.p.p)+(this.p.n-n)*Math.log(1-this.p.p))}cdf(t){let n=parseInt(t);return n<=0?0:n>this.p.n?1:r.betaIncomplete(this.p.n-n,1+n,1-this.p.p)}}class c extends o{constructor(t,n,i){super("continuous",arguments.length);this.p={xmin:t,xmax:n,alpha:i};this.c=[Math.pow(t,i),Math.pow(n,i),1-Math.pow(t/n,i)]}_generator(){return Math.pow((this.c[1]+Math.random()*(this.c[0]-this.c[1]))/(this.c[0]*this.c[1]),-1/this.p.alpha)}pdf(t){return t<this.p.xmin||t>this.p.xmax?0:this.p.alpha*Math.pow(this.p.xmin/t,this.p.alpha)/(t*this.c[2])}cdf(t){return t<this.p.xmin?0:t>this.p.xmax?1:(1-this.c[0]*Math.pow(t,-this.p.alpha))/(1-this.c[0]/this.c[1])}}class l extends o{constructor(t){super("discrete",arguments.length);this.p={n:t.length,weights:t};let n=t.length,i=[0],h=[0],e=0;if(t.length>1){for(let i=0;i<n;i++)e+=t[i];let r=[],a=[],s=[];for(let i=0;i<n;i++){r.push(n*t[i]/e);if(r[i]<1)a.push(i);else s.push(i)}i=[];h=[];for(let t=0;t<n;t++){i.push(1);h.push(t)}let o=0,u=0;while(a.length>0&&s.length>0){o=a.shift();u=s.shift();i[o]=r[o];h[o]=u;r[u]+=r[o]-1;if(r[u]<1)a.push(u);else s.push(u)}while(s.length>0){u=s.shift();i[u]=1;h[u]=u}while(a.length>0){o=a.shift();i[o]=1;h[o]=o}}let r=[t[0]/e],a=[t[0]/e];for(let n=1;n<t.length;n++){r.push(t[n]/e);a.push(a[n-1]+t[n]/e)}this.c=[i,h,r,a]}_generator(){if(this.p.n<=1){return 0}let t=Math.floor(Math.random()*this.p.n);if(Math.random()<this.c[0][t])return t;else return this.c[1][t]}pdf(t){let n=parseInt(t);return n<0||n>=this.p.weights.length?0:this.c[2][n]}cdf(t){let n=parseInt(t);return n<0?0:n>=this.p.weights.length?1:this.c[3][n]}}class m extends o{constructor(t){super("continuous",arguments.length);this.p={x0:t}}_generator(){return this.p.x0}pdf(t){return t===this.p.x0?1:0}cdf(t){return t<this.p.x0?0:t>this.p.x0?1:.5}}class M extends o{constructor(t){super("continuous",arguments.length);this.p={lambda:t}}_generator(){return-Math.log(Math.random())/this.p.lambda}pdf(t){return this.p.lambda*Math.exp(-this.p.lambda*t)}cdf(t){return 1-Math.exp(-this.p.lambda*t)}}class g extends o{constructor(t,n){super("continuous",arguments.length);this.p={alpha:t,beta:n};this.c=[Math.pow(n,t),r.gamma(t)]}_generator(){return e(this.p.alpha,this.p.beta)}pdf(t){return t<=0?0:this.c[0]*Math.exp((this.p.alpha-1)*Math.log(t)-this.p.beta*t)/this.c[1]}cdf(t){return r.gammaLowerIncomplete(this.p.alpha,this.p.beta*t)/this.c[1]}}class d extends g{constructor(t,n){super(Math.round(t),n)}}class x extends g{constructor(t){super(Math.round(t)/2,.5)}}class w extends o{constructor(t,n,i){super("continuous",arguments.length);this.p={a:t,d:n,p:i};this.c=[r.gamma(n/i),i/Math.pow(t,n),1/Math.pow(t,i)]}_generator(){return Math.pow(e(this.p.d/this.p.p,this.c[2]),1/this.p.p)}pdf(t){return t<=0?0:this.c[1]*Math.exp((this.p.d-1)*Math.log(t)-Math.pow(t/this.p.a,this.p.p))/this.c[0]}cdf(t){return r.gammaLowerIncomplete(this.p.d/this.p.p,Math.pow(t/this.p.a,this.p.p))/this.c[0]}}class b extends o{constructor(t,n){super("continuous",arguments.length);this.p={alpha:t,beta:n};this.c=[Math.pow(n,t)/r.gamma(t),r.gamma(t)]}_generator(){return 1/e(this.p.alpha,this.p.beta)}pdf(t){return t<=0?0:this.c[0]*Math.pow(t,-1-this.p.alpha)*Math.exp(-this.p.beta/t)}cdf(t){return 1-r.gammaLowerIncomplete(this.p.alpha,this.p.beta/t)/this.c[1]}}class y extends o{constructor(t,n){super("continuous",arguments.length);this.p={mu:t,sigma:n};this.c=[n*Math.sqrt(2*Math.PI),n*Math.SQRT2]}_generator(){return Math.exp(this.p.mu+this.p.sigma*i(0,1))}pdf(t){return t<=0?0:Math.exp(-.5*Math.pow((Math.log(t)-this.p.mu)/this.p.sigma,2))/(t*this.c[0])}cdf(t){return t<=0?0:.5*(1+r.erf((Math.log(t)-this.p.mu)/this.c[1]))}}class _ extends o{constructor(t,n){super("continuous",arguments.length);this.p={mu:t,sigma:n};this.c=[n*Math.sqrt(2*Math.PI),n*Math.SQRT2]}_generator(){return i(this.p.mu,this.p.sigma)}pdf(t){return Math.exp(-.5*Math.pow((t-this.p.mu)/this.p.sigma,2))/this.c[0]}cdf(t){return.5*(1+r.erf((t-this.p.mu)/this.c[1]))}}class A extends o{constructor(t,n){super("continuous",arguments.length);this.p={xmin:t,alpha:n}}_generator(){return this.p.xmin/Math.pow(Math.random(),1/this.p.alpha)}pdf(t){return t<this.p.xmin?0:this.p.alpha*Math.pow(this.p.xmin/t,this.p.alpha)/t}cdf(t){return t<this.p.xmin?0:1-Math.pow(this.p.xmin/t,this.p.alpha)}}class I extends o{constructor(t){super("discrete",arguments.length);this.p={lambda:t}}_generator(){if(this.p.lambda<30){let t=Math.exp(-this.p.lambda),n=0,i=1;do{n++;i*=Math.random()}while(i>t)return n-1}else{let t=.767-3.36/this.p.lambda,n=Math.PI/Math.sqrt(3*this.p.lambda),i=n*this.p.lambda,h=Math.log(t)-this.p.lambda-Math.log(n);while(true){let t=Math.random(),e=(i-Math.log((1-t)/t))/n,a=Math.floor(e+.5);if(a<0)continue;let s=Math.random(),o=i-n*e,u=o+Math.log(s/Math.pow(1+Math.exp(o),2)),f=h+a*Math.log(this.p.lambda)-r.gammaLn(a+1);if(u<=f)return a}}}pdf(t){let n=parseInt(t);return n<0?0:Math.pow(this.p.lambda,n)*Math.exp(-this.p.lambda)/r.gamma(n+1)}cdf(t){let n=parseInt(t);return n<0?0:1-r.gammaLowerIncomplete(n+1,this.p.lambda)/r.gamma(n+1)}}class L extends o{constructor(t,n){super("continuous",arguments.length);this.p={xmin:t,xmax:n};this.c=[n-t]}_generator(){return Math.random()*this.c[0]+this.p.xmin}pdf(t){return t<this.p.xmin||t>this.p.xmax?0:1/this.c[0]}cdf(t){return t<this.p.xmin?0:t>this.p.xmax?1:(t-this.p.xmin)/this.c[0]}}class j extends o{constructor(t,n){super("discrete",arguments.length);this.p={xmin:t,xmax:n};this.c=[n-t+1]}_generator(){return parseInt(Math.random()*this.c[0])+this.p.xmin}pdf(t){let n=parseInt(t);return n<this.p.xmin||n>this.p.xmax?0:1/this.c[0]}cdf(t){let n=parseInt(t);return n<this.p.xmin?0:n>this.p.xmax?1:(1+n-this.p.xmin)/this.c[0]}}class v extends o{constructor(t,n){super("continuous",arguments.length);this.p={lambda:t,k:n}}_generator(){return this.p.lambda*Math.pow(-Math.log(Math.random()),1/this.p.k)}pdf(t){return t<0?0:this.p.k/this.p.lambda*Math.exp((this.p.k-1)*Math.log(t/this.p.lambda)-Math.pow(t/this.p.lambda,this.p.k))}cdf(t){return t<0?0:1-Math.exp(-Math.pow(t/this.p.lambda,this.p.k))}}return{Bernoulli:u,Beta:f,Binomial:p,BoundedPareto:c,Chi2:x,Custom:l,Degenerate:m,Erlang:d,Exponential:M,Gamma:g,GeneralizedGamma:w,InverseGamma:b,Lognormal:y,Normal:_,Pareto:A,Poisson:I,UniformContinuous:L,UniformDiscrete:j,Weibull:v}}();let o=function(){class t{constructor(t=1){this.dim=t;this.n=0;this.x=new Array(this.dim).fill(0);this.xy=Array.from({length:this.dim},()=>new Array(this.dim).fill(0))}reset(){this.n=0;this.x=new Array(this.dim).fill(0);this.xy=Array.from({length:this.dim},()=>new Array(this.dim).fill(0))}update(t){this.x=this.x.map((n,i)=>(this.n*n+t[i])/(this.n+1));this.xy=this.xy.map((n,i)=>n.map((n,h)=>(this.n*n+t[i]*t[h])/(this.n+1)));this.n++}compute(){return new e.Matrix(this.xy.map((t,n)=>t.map((t,i)=>t-this.x[n]*this.x[i])))}}class n{constructor(t=1,n=100,i=1e4){this.dim=t;this.range=n;this.maxSize=i;this.history=Array.from({length:t},()=>[])}_aci(t){let n=t.reduce((t,n)=>t+n)/t.length,i=t.reduce((t,n)=>t+n*n),h=new Array(this.range).fill(0);for(let i=0;i<t.length;i++){for(let e=0;e<h.length;e++){if(i-e>0){h[e]+=(t[i]-n)*(t[i-e]-n)}}}return h.map(function(h){return h/(i-t.length*n*n)})}reset(){this.history=Array.from({length:this.dim},()=>[])}update(t){this.history.forEach((n,i)=>n.push(t[i]));if(this.history[0].length>=this.maxSize){this.history.forEach(t=>t.shift())}}compute(){return this.history.map(t=>this._aci(t))}}return{Cov:t,AC:n}}();let u=function(){const t=1e4;let h=function(){function t(t,i){let h=[],e=[];t.forEach(function(t){let r=t.map(function(t){return t[i]});let a=n(r)/r.length,s=(n(r,2)-r.length*a*a)/(r.length-1);h.push(a);e.push(s)});let r=n(e)/t.length,a=n(h)/t.length,s=(n(h,2)-t.length*a*a)*t[0].length/(t.length-1),o=((t[0].length-1)*r+s)/t[0].length;return Math.sqrt(o/r)}return function(n,i){return n[0][0].map(function(h,e){return new Array(i||1e3).fill(0).map(function(i,h){return t(n.map(function(t){return t.slice(0,h+2)}),e)})})}}();let e=function(t,n){let h=n&&typeof n.min!=="undefined"?n.min:null,e=n&&typeof n.max!=="undefined"?n.max:null,r=Math.random(),a=new s.Exponential(1);function o(t){return(!h||t>=h[0])&&(!e||t>=e[0])}function u(n,i,h,e){let a=h,s=e,o=false;while(s-a>1.1){let h=(a+s)/2;o=r<h&&n>=h||r>=h&&n<h;if(n<h){s=h}else{a=h}if(o&&i>=t(a)&&i>=t(s)){return false}}return true}function f(){let n=t(r)-a.sample(),h=r-Math.random(),e=h+1;while(n<t(h)||n<t(e)){if(Math.random()<.5){h-=e-h}else{e+=e-h}}let s=i(h,e);while(!o(s)||n>t(s)||!u(s,n,h,e)){if(s<r){h=s}else{e=s}s=i(h,e)}r=s;return r}function p(){return null}function c(t){return new Array(t||1e6).fill(0).map(function(){return[f()]})}return{burnIn:p,sample:c}};class r{constructor(i,h={},e={}){this.dim=h.dim||1;this.maxHistory=h.maxHistory||t;this.lnp=i;this.x=e.x||Array.from({length:self.dim},Math.random);this.samplingRate=e.samplingRate||1;this.internal=e.internal||{};this.history=function(t){let n=Array.from({length:t.dim},()=>[]);return{get(){return n},update(i){n.forEach((t,n)=>t.push(i[n]));if(n[0].length>=t.maxHistory){n.forEach(t=>t.shift())}}}}(this);this.acceptance=function(t){let i=[];return{compute(){return n(i)/i.length},update(n){i.push(n);if(i.length>t.maxHistory){i.shift()}}}}(this)}_internal(){throw Error("MCMC._internal() is not implemented")}_iter(t,n=false){throw Error("MCMC._iter() is not implemented")}_adjust(t){throw Error("MCMC._adjust() is not implemented")}state(){return{x:this.x,samplingRate:this.samplingRate,internals:this._internal()}}statistics(){return this.history.get().map(t=>{let n=t.reduce((t,n)=>t+n,0)/t.length,i=t.reduce((t,i)=>t+(i-n)*(i-n),0)/t.length;return{mean:n,std:i,cv:i/n}})}ar(){return this.acceptance.compute()}ac(){return this.history.get().map(t=>{let n=t.reduce((t,n)=>t+n)/t.length,i=t.reduce((t,n)=>t+n*n),h=new Array(100).fill(0);for(let i=0;i<t.length;i++){for(let e=0;e<h.length;e++){if(i-e>0){h[e]+=(t[i]-n)*(t[i-e]-n)}}}return h.map(function(h){return h/(i-t.length*n*n)})})}iterate(t=null,n=false){let i=this._iter(this.state.x,n);this.history.update(i.x);this.acceptance.update(i.accepted);this.x=i.x;t&&t(i.x,i.accepted);return i}warmUp(t,n=100){for(let i=0;i<=n;i++){for(let t=0;t<1e4;t++){this._adjust(this.iterate(null,true))}let h=this.ac().reduce((t,n)=>{for(let i=0;i<n.length-1;i++){if(Math.abs(n[i])<=.05){return Math.max(t,i)}}},0);if(h>this.samplingRate){this.samplingRate++}else if(h<this.samplingRate&&this.samplingRate>1){this.samplingRate--}t&&t(100*i/n)}}sample(t,n=1e3){let i=this.samplingRate*n,h=i/100,e=[];for(let n=0;n<i;n++){this.iterate();if(n%h===0){t&&t(n/h)}if(n%this.samplingRate===0){e.push(this.x)}}return e}}class a extends r{constructor(t,n,i){super(t,n,i);this.lastLnp=this.lnp(this.x);this.proposal=function(t){let n=new s.Normal(0,1),i=new Array(t.dim).fill(0),h=t.internal.proposal||new Array(t.dim).fill(1),e=h.map(t=>Math.log(t)),r=0,a=0,o=0;return{jump(t,i){return i?t.map((t,i)=>t+(i===o?n.sample()*h[o]:0)):t.map((t,i)=>t+n.sample()*h[i])},update(n){n&&i[o]++;r++;if(r===100){if(i[o]/100>.44){e[o]+=Math.min(.01,Math.pow(a,-.5))}else{e[o]-=Math.min(.01,Math.pow(a,-.5))}h[o]=Math.exp(e[o]);r=0;i[o]=0;o=(o+1)%t.dim;if(o===0){a++}}},scales(){return h.slice()}}}(this)}_internal(){return{proposal:this.proposal.scales()}}_iter(t,n){let i=this.proposal.jump(this.x,n);let h=this.lnp(i),e=Math.random()<Math.exp(h-this.lastLnp);if(e){this.lastLnp=h}else{i=this.x}return{x:i,accepted:e}}_adjust(t){this.proposal.update(t.accepted)}}class o extends r{constructor(t,n,i,h){super(t,i,h)}}return{gr:h,Slice:e,RWM:a}}();t.special=r;t.stat=o;t.linalg=e;t.core=a;t.dist=s;t.mc=u});