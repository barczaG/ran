(function(t,n){if(typeof exports==="object"&&typeof module!=="undefined"){n(exports)}else if(typeof define==="function"&&define["amd"]){define(["exports"],n)}else{n(t.ran=t["ran"]||{})}})(this,function(t){"use strict";function n(t,n=1){if(n!==1){return t.reduce((t,i)=>{return t+Math.pow(i,n)},0)}else{return t.reduce((t,n)=>{return t+n},0)}}function i(t,n){return t<n?Math.random()*(n-t)+t:Math.random()*(t-n)+n}function e(t,n=1){if(n<2)return t();else{return Array.from({length:n},()=>t())}}let r=function(){class t{constructor(t){if(typeof t==="number"){this._v=new Array(t).fill(0);this._v[0]=1}else if(Array.isArray(t)){this._v=t}else if(typeof t==="object"&&Array.isArray(t.v)){this._v=t.v}else{this._v=[1,0,0]}}set v(t){this._v=t}get v(){return this._v.slice()}get dim(){return this._v.length}mult(n){return new t(this._v.map(t=>t*n))}add(n){return new t(this._v.map((t,i)=>t+n.v[i]))}dot(t){return this._v.reduce((n,i,e)=>n+i*t.v[e],0)}}class n{constructor(t){if(typeof t==="number"){this._m=Array.from({length:t},()=>new Array(t).fill(0));for(let n=0;n<t;n++){this._m[n][n]=1}}else if(Array.isArray(t)){this._m=t}else if(typeof t==="object"&&Array.isArray(t.m)){this._m=t.m}else{this._m=[[1,0,0],[0,1,0],[0,0,1]]}}set m(t){this._m=t}get m(){return this._m.map(t=>t.slice())}get dim(){return this._m.length}ij(t,n,i){if(i!==undefined){this._m[t][n]=i}else{return this._m[t][n]}}t(){let t=this.dim,i=new n(t);for(let n=0;n<t;n++){for(let e=0;e<t;e++){i.ij(n,e,this.m[e][n])}}return i}scale(t){return new n(this._m.map(n=>n.map(n=>n*t)))}mult(t){let i=this.dim;let e=new n(i);for(let n=0;n<i;n++){for(let r=0;r<i;r++){let h=0;for(let e=0;e<i;e++){h+=this.ij(n,e)*t.ij(e,r)}e.ij(n,r,h)}}return e}act(n){return new t(this._m.map(i=>n.dot(new t(i))))}ldl(){let t=this.dim,i=new n(t),e=new n(t);for(let n=0;n<t;n++){let r=this.ij(n,n);for(let t=0;t<n;t++){r-=i.ij(t,t)*e.ij(n,t)*e.ij(n,t)}i.ij(n,n,r);for(let h=t-1;h>n;h--){let t=this.ij(h,n);for(let r=0;r<n;r++){t-=i.ij(r,r)*e.ij(h,r)*e.ij(n,r)}e.ij(h,n,t/r)}}return{D:i,L:e}}}}();let h=function(){const t=100;const n=1e-10;let i=function(){const t=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];function n(i){let e=0;if(i<.5){e=Math.PI/(Math.sin(Math.PI*i)*n(1-i))}else{i--;let n=.9999999999998099,r=t.length;t.forEach((t,h)=>{n+=t/(i+h+1);let a=i+r-.5;e=Math.sqrt(2*Math.PI)*Math.pow(a,i+.5)*Math.exp(-a)*n})}return e}return n}();let e=function(){const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];return function(n){let i=n,e=n,r=i+5.5;r=(i+.5)*Math.log(r)-r;let h=1.000000000190015;for(let n=0;n<6;n++){e++;h+=t[n]/e}return r+Math.log(2.5066282746310007*h/i)}}();let r=function(){const e=1e-30;function r(i,e){if(e<0){return 0}else{let r=i,h=1/i,a=1/i;for(let i=0;i<t;i++){r++;h*=e/r;a+=h;if(h<a*n)break}return Math.exp(-e)*Math.pow(e,i)*a}}function h(i,r){let h=r+1-i,a=1/e,u=1/h,o=u,s,p;for(let r=1;r<t;r++){s=r*(i-r);h+=2;u=s*u+h;if(Math.abs(u)<e)u=e;u=1/u;a=h+s/a;if(Math.abs(a)<e)a=e;p=a*u;o*=p;if(Math.abs(p-1)<n)break}return Math.exp(-r)*Math.pow(r,i)*o}return function(t,n){return n<t+1?r(t,n):i(t)-h(t,n)}}();let h=function(){const i=1e-30;function r(e,r,h){let a=e+r,u=e+1,o=e-1,s=1,p=1-a*h/u;if(Math.abs(p)<i)p=i;p=1/p;let f=p;for(let c=1;c<t;c++){let t=2*c,l=c*(r-c)*h/((o+t)*(e+t));p=1+l*p;if(Math.abs(p)<i)p=i;s=1+l/s;if(Math.abs(s)<i)s=i;p=1/p;f*=p*s;l=-(e+c)*(a+c)*h/((e+t)*(u+t));p=1+l*p;if(Math.abs(p)<i)p=i;s=1+l/s;if(Math.abs(s)<i)s=i;p=1/p;let m=p*s;f*=m;if(Math.abs(m-1)<n)break}return f}return function(t,n,i){let h=i<=0||i>=1?0:Math.exp(e(t+n)-e(t)-e(n)+t*Math.log(i)+n*Math.log(1-i));return i<(t+1)/(t+n+2)?h*r(t,n,i)/t:1-h*r(n,t,1-i)/n}}();let a=function(){const t=[-1.26551223,1.00002368,.37409196,.09678418,-.18628806,.27886807,-1.13520398,1.48851587,-.82215223,.17087277];return function(n){let i=1/(1+.5*Math.abs(n)),e=1,r=0;t.forEach(t=>{r+=t*e;e*=i});let h=i*Math.exp(r-n*n);return n<0?h-1:1-h}}();return{gamma:i,gammaLn:e,gammaLowerIncomplete:r,betaIncomplete:h,erf:a}}();let a=function(){function t(t,n,r){if(arguments.length===0)return i(0,1);if(arguments.length===1)return i(0,t);return e(()=>i(t,n),r)}function n(t,n,r){if(arguments.length===1)return Math.floor(i(0,t+1));return e(()=>Math.floor(i(t,n+1)),r)}function r(t,n){if(t===null||t===undefined||t.length===0)return null;return e(()=>t[Math.floor(i(0,t.length))],n)}function h(t,n){if(t===null||t===undefined||t.length===0)return null;return e(()=>t.charAt(Math.floor(i(0,t.length))),n)}function a(t){let n,i,e=t.length;while(e){n=Math.floor(Math.random()*e--);i=t[e];t[e]=t[n];t[n]=i}return t}function u(t,n,i,r){let h=typeof i==="number"?i:.5;return e(()=>Math.random()<h?t:n,r)}return{float:t,int:n,choice:r,char:h,shuffle:a,coin:u}}();let u=function(){const t=[0,7.879,10.597,12.838,14.86,16.75,18.548,20.278,21.955,23.589,25.188,26.757,28.3,29.819,31.319,32.801,34.267,35.718,37.156,38.582,39.997,41.401,42.796,44.181,45.559,46.928,48.29,49.645,50.993,52.336,53.672,55.003,56.328,57.648,58.964,60.275,61.581,62.883,64.181,65.476,66.766,68.053,69.336,70.616,71.893,73.166,74.437,75.704,76.969,78.231,79.49,80.747,82.001,83.253,84.502,85.749,86.994,88.236,89.477,90.715,91.952,93.186,94.419,95.649,96.878,98.105,99.33,100.554,101.776,102.996,104.215,105.432,106.648,107.862,109.074,110.286,111.495,112.704,113.911,115.117,116.321,117.524,118.726,119.927,121.126,122.325,123.522,124.718,125.913,127.106,128.299,129.491,130.681,131.871,133.059,134.247,135.433,136.619,137.803,138.987,140.169,141.351,142.532,143.712,144.891,146.07,147.247,148.424,149.599,150.774,151.948,153.122,154.294,155.466,156.637,157.808,158.977,160.146,161.314,162.481,163.648,164.814,165.98,167.144,168.308,169.471,170.634,171.796,172.957,174.118,175.278,176.438,177.597,178.755,179.913,181.07,182.226,183.382,184.538,185.693,186.847,188.001,189.154,190.306,191.458,192.61,193.761,194.912,196.062,197.211,198.36,199.509,200.657,201.804,202.951,204.098,205.244,206.39,207.535,208.68,209.824,210.968,212.111,213.254,214.396,215.539,216.68,217.821,218.962,220.102,221.242,222.382,223.521,224.66,225.798,226.936,228.074,229.211,230.347,231.484,232.62,233.755,234.891,236.026,237.16,238.294,239.428,240.561,241.694,242.827,243.959,245.091,246.223,247.354,248.485,249.616,250.746,251.876,253.006,254.135,255.264,256.393,257.521,258.649,259.777,260.904,262.031,263.158,264.285,265.411,266.537,267.662,268.788,269.912,271.037,272.162,273.286,274.409,275.533,276.656,277.779,278.902,280.024,281.146,282.268,283.39,284.511,285.632,286.753,287.874,288.994,290.114,291.234,292.353,293.472,294.591,295.71,296.828,297.947,299.065,300.182,301.3,302.417,303.534,304.651,305.767,306.883,307.999,309.115,310.231,311.346];const n=[366.844,421.9,476.606,531.026,585.207,639.183,692.982,746.625,800.131,853.514,906.786,959.957,1013.036,1066.031,1118.948];function i(t,n){let i=Math.random(),e=Math.random();return n*Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*e)+t}function r(t,n){if(t>1){let e=t-1/3,r=1/Math.sqrt(9*e),h,a,u;while(true){h=i(0,1);if(h>-1/r){a=Math.pow(1+r*h,3);u=Math.random();if(Math.log(u)<.5*h*h+e*(1-a+Math.log(a)))return e*a/n}}}else{return r(t+1,n)*Math.pow(Math.random(),1/t)}}function a(i,e,r){let h={};i.forEach(function(t){h[t]=h[t]?h[t]+1:1});let a=0,u=i.length;for(let t in h){let n=e(parseInt(t))*u;a+=Math.pow(h[t]-n,2)/n}let o=Math.max(1,Object.keys(h).length-r-1),s=o<=250?t[o]:n[Math.floor(o/50)];return{statistics:a,passed:a<=s}}function u(t,n){t.sort((t,n)=>t-n);let i=0;for(let e=0;e<t.length;e++){i=Math.max(i,Math.abs((e+1)/t.length-n(t[e])))}return{statistics:i,passed:i<=1.628/Math.sqrt(t.length)}}class o{constructor(t,n){this.type=t;this.k=n;this.p=[];this.c=[]}_generator(){}sample(t){return e(()=>this._generator(),t)}pdf(t){}cdf(t){}survival(t){return 1-this.cdf(t)}hazard(t){return this.pdf(t)/this.survival(t)}cumulativeHazard(t){return-Math.log(this.survival(t))}lnPdf(t){return Math.log(this.pdf(t))}L(t){return t.reduce((t,n)=>t+Math.log(this.pdf(n)),0)}test(t){return this.type==="discrete"?a(t,t=>this.pdf(t),this.k):u(t,t=>this.cdf(t))}}class s extends o{constructor(t){super("discrete",arguments.length);this.p={p:t}}_generator(){return Math.random()<this.p.p?1:0}pdf(t){return parseInt(t)===1?this.p.p:1-this.p.p}cdf(t){return t<0?0:parseInt(t)>=1?1:1-this.p.p}}class p extends o{constructor(t,n){super("continuous",arguments.length);this.p={alpha:t,beta:n};this.c=[Math.exp(h.gammaLn(t)+h.gammaLn(n)-h.gammaLn(t+n))]}_generator(){let t=r(this.p.alpha,1),n=r(this.p.beta,1);return t/(t+n)}pdf(t){return Math.pow(t,this.p.alpha-1)*Math.pow(1-t,this.p.beta-1)/this.c[0]}cdf(t){return t<=0?0:t>=1?1:h.betaIncomplete(this.p.alpha,this.p.beta,t)}}class f extends o{constructor(t,n){super("continuous",arguments.length);let i=n<=.5?n:1-n;this.p={n:t,p:n};this.c=[i,t*i]}_generator(){if(this.p.n<25){let t=0;for(let n=1;n<=this.p.n;n++)if(Math.random()<this.c[0])t++;return this.c[0]===this.p.p?t:this.p.n-t}else if(this.c[1]<1){let t=Math.exp(-this.c[1]),n=1,i=0;for(i=0;i<=this.p.n;i++){n*=Math.random();if(n<t)break}let e=i<=this.p.n?i:this.p.n;return this.c[0]===this.p.p?e:this.p.n-e}else{let t=this.p.n,n=h.gammaLn(t+1),i=1-this.c[0],e=Math.log(this.c[0]),r=Math.log(i),a=Math.sqrt(2*this.c[1]*i);let u,o,s;do{do{u=Math.tan(Math.PI*Math.random());o=a*u+this.c[1]}while(o<0||o>=t+1)o=Math.floor(o);s=1.2*a*(1+u*u)*Math.exp(n-h.gammaLn(o+1)-h.gammaLn(t-o+1)+o*e+(t-o)*r)}while(Math.random()>s)return this.c[0]===this.p.p?o:this.p.n-o}}pdf(t){let n=parseInt(t);return n<0?0:n>this.p.n?0:Math.exp(h.gammaLn(this.p.n+1)-h.gammaLn(n+1)-h.gammaLn(this.p.n-n+1)+n*Math.log(this.p.p)+(this.p.n-n)*Math.log(1-this.p.p))}cdf(t){let n=parseInt(t);return n<=0?0:n>this.p.n?1:h.betaIncomplete(this.p.n-n,1+n,1-this.p.p)}}class c extends o{constructor(t,n,i){super("continuous",arguments.length);this.p={xmin:t,xmax:n,alpha:i};this.c=[Math.pow(t,i),Math.pow(n,i),1-Math.pow(t/n,i)]}_generator(){return Math.pow((this.c[1]+Math.random()*(this.c[0]-this.c[1]))/(this.c[0]*this.c[1]),-1/this.p.alpha)}pdf(t){return t<this.p.xmin||t>this.p.xmax?0:this.p.alpha*Math.pow(this.p.xmin/t,this.p.alpha)/(t*this.c[2])}cdf(t){return t<this.p.xmin?0:t>this.p.xmax?1:(1-this.c[0]*Math.pow(t,-this.p.alpha))/(1-this.c[0]/this.c[1])}}class l extends o{constructor(t){super("discrete",arguments.length);this.p={n:t.length,weights:t};let n=t.length,i=[0],e=[0],r=0;if(t.length>1){for(let i=0;i<n;i++)r+=t[i];let h=[],a=[],u=[];for(let i=0;i<n;i++){h.push(n*t[i]/r);if(h[i]<1)a.push(i);else u.push(i)}i=[];e=[];for(let t=0;t<n;t++){i.push(1);e.push(t)}let o=0,s=0;while(a.length>0&&u.length>0){o=a.shift();s=u.shift();i[o]=h[o];e[o]=s;h[s]+=h[o]-1;if(h[s]<1)a.push(s);else u.push(s)}while(u.length>0){s=u.shift();i[s]=1;e[s]=s}while(a.length>0){o=a.shift();i[o]=1;e[o]=o}}let h=[t[0]/r],a=[t[0]/r];for(let n=1;n<t.length;n++){h.push(t[n]/r);a.push(a[n-1]+t[n]/r)}this.c=[i,e,h,a]}_generator(){if(this.p.n<=1){return 0}let t=Math.floor(Math.random()*this.p.n);if(Math.random()<this.c[0][t])return t;else return this.c[1][t]}pdf(t){let n=parseInt(t);return n<0||n>=this.p.weights.length?0:this.c[2][n]}cdf(t){let n=parseInt(t);return n<0?0:n>=this.p.weights.length?1:this.c[3][n]}}class m extends o{constructor(t){super("continuous",arguments.length);this.p={x0:t}}_generator(){return this.p.x0}pdf(t){return t===this.p.x0?1:0}cdf(t){return t<this.p.x0?0:t>this.p.x0?1:.5}}class M extends o{constructor(t){super("continuous",arguments.length);this.p={lambda:t}}_generator(){return-Math.log(Math.random())/this.p.lambda}pdf(t){return this.p.lambda*Math.exp(-this.p.lambda*t)}cdf(t){return 1-Math.exp(-this.p.lambda*t)}}class g extends o{constructor(t,n){super("continuous",arguments.length);this.p={alpha:t,beta:n};this.c=[Math.pow(n,t),h.gamma(t)]}_generator(){return r(this.p.alpha,this.p.beta)}pdf(t){return t<=0?0:this.c[0]*Math.exp((this.p.alpha-1)*Math.log(t)-this.p.beta*t)/this.c[1]}cdf(t){return h.gammaLowerIncomplete(this.p.alpha,this.p.beta*t)/this.c[1]}}class d extends g{constructor(t,n){super(Math.round(t),n)}}class x extends g{constructor(t){super(Math.round(t)/2,.5)}}class w extends o{constructor(t,n,i){super("continuous",arguments.length);this.p={a:t,d:n,p:i};this.c=[h.gamma(n/i),i/Math.pow(t,n),1/Math.pow(t,i)]}_generator(){return Math.pow(r(this.p.d/this.p.p,this.c[2]),1/this.p.p)}pdf(t){return t<=0?0:this.c[1]*Math.exp((this.p.d-1)*Math.log(t)-Math.pow(t/this.p.a,this.p.p))/this.c[0]}cdf(t){return h.gammaLowerIncomplete(this.p.d/this.p.p,Math.pow(t/this.p.a,this.p.p))/this.c[0]}}class b extends o{constructor(t,n){super("continuous",arguments.length);this.p={alpha:t,beta:n};this.c=[Math.pow(n,t)/h.gamma(t),h.gamma(t)]}_generator(){return 1/r(this.p.alpha,this.p.beta)}pdf(t){return t<=0?0:this.c[0]*Math.pow(t,-1-this.p.alpha)*Math.exp(-this.p.beta/t)}cdf(t){return 1-h.gammaLowerIncomplete(this.p.alpha,this.p.beta/t)/this.c[1]}}class y extends o{constructor(t,n){super("continuous",arguments.length);this.p={mu:t,sigma:n};this.c=[n*Math.sqrt(2*Math.PI),n*Math.SQRT2]}_generator(){return Math.exp(this.p.mu+this.p.sigma*i(0,1))}pdf(t){return t<=0?0:Math.exp(-.5*Math.pow((Math.log(t)-this.p.mu)/this.p.sigma,2))/(t*this.c[0])}cdf(t){return t<=0?0:.5*(1+h.erf((Math.log(t)-this.p.mu)/this.c[1]))}}class I extends o{constructor(t,n){super("continuous",arguments.length);this.p={mu:t,sigma:n};this.c=[n*Math.sqrt(2*Math.PI),n*Math.SQRT2]}_generator(){return i(this.p.mu,this.p.sigma)}pdf(t){return Math.exp(-.5*Math.pow((t-this.p.mu)/this.p.sigma,2))/this.c[0]}cdf(t){return.5*(1+h.erf((t-this.p.mu)/this.c[1]))}}class _ extends o{constructor(t,n){super("continuous",arguments.length);this.p={xmin:t,alpha:n}}_generator(){return this.p.xmin/Math.pow(Math.random(),1/this.p.alpha)}pdf(t){return t<this.p.xmin?0:this.p.alpha*Math.pow(this.p.xmin/t,this.p.alpha)/t}cdf(t){return t<this.p.xmin?0:1-Math.pow(this.p.xmin/t,this.p.alpha)}}class A extends o{constructor(t){super("discrete",arguments.length);this.p={lambda:t}}_generator(){if(this.p.lambda<30){let t=Math.exp(-this.p.lambda),n=0,i=1;do{n++;i*=Math.random()}while(i>t)return n-1}else{let t=.767-3.36/this.p.lambda,n=Math.PI/Math.sqrt(3*this.p.lambda),i=n*this.p.lambda,e=Math.log(t)-this.p.lambda-Math.log(n);while(true){let t=Math.random(),r=(i-Math.log((1-t)/t))/n,a=Math.floor(r+.5);if(a<0)continue;let u=Math.random(),o=i-n*r,s=o+Math.log(u/Math.pow(1+Math.exp(o),2)),p=e+a*Math.log(this.p.lambda)-h.gammaLn(a+1);if(s<=p)return a}}}pdf(t){let n=parseInt(t);return n<0?0:Math.pow(this.p.lambda,n)*Math.exp(-this.p.lambda)/h.gamma(n+1)}cdf(t){let n=parseInt(t);return n<0?0:1-h.gammaLowerIncomplete(n+1,this.p.lambda)/h.gamma(n+1)}}class v extends o{constructor(t,n){super("continuous",arguments.length);this.p={xmin:t,xmax:n};this.c=[n-t]}_generator(){return Math.random()*this.c[0]+this.p.xmin}pdf(t){return t<this.p.xmin||t>this.p.xmax?0:1/this.c[0]}cdf(t){return t<this.p.xmin?0:t>this.p.xmax?1:(t-this.p.xmin)/this.c[0]}}class j extends o{constructor(t,n){super("discrete",arguments.length);this.p={xmin:t,xmax:n};this.c=[n-t+1]}_generator(){return parseInt(Math.random()*this.c[0])+this.p.xmin}pdf(t){let n=parseInt(t);return n<this.p.xmin||n>this.p.xmax?0:1/this.c[0]}cdf(t){let n=parseInt(t);return n<this.p.xmin?0:n>this.p.xmax?1:(1+n-this.p.xmin)/this.c[0]}}class L extends o{constructor(t,n){super("continuous",arguments.length);this.p={lambda:t,k:n}}_generator(){return this.p.lambda*Math.pow(-Math.log(Math.random()),1/this.p.k)}pdf(t){return t<0?0:this.p.k/this.p.lambda*Math.exp((this.p.k-1)*Math.log(t/this.p.lambda)-Math.pow(t/this.p.lambda,this.p.k))}cdf(t){return t<0?0:1-Math.exp(-Math.pow(t/this.p.lambda,this.p.k))}}return{Bernoulli:s,Beta:p,Binomial:f,BoundedPareto:c,Chi2:x,Custom:l,Degenerate:m,Erlang:d,Exponential:M,Gamma:g,GeneralizedGamma:w,InverseGamma:b,Lognormal:y,Normal:I,Pareto:_,Poisson:A,UniformContinuous:v,UniformDiscrete:j,Weibull:L}}();let o=function(){let t=function(){function t(t,i){let e=[],r=[];t.forEach(function(t){let h=t.map(function(t){return t[i]});let a=n(h)/h.length,u=(n(h,2)-h.length*a*a)/(h.length-1);e.push(a);r.push(u)});let h=n(r)/t.length,a=n(e)/t.length,u=(n(e,2)-t.length*a*a)*t[0].length/(t.length-1),o=((t[0].length-1)*h+u)/t[0].length;return Math.sqrt(o/h)}return function(n,i){return n[0][0].map(function(e,r){return new Array(i||1e3).fill(0).map(function(i,e){return t(n.map(function(t){return t.slice(0,e+2)}),r)})})}}();let e=function(t,n){let i=n||1;let e=Array.from({length:t},()=>new u.Normal(0,1));function r(t){i=t?i*1.2:i*.8;return i}function h(t){return t.map((t,n)=>t+i*e[n].sample())}function a(){return 1}return{update:r,sample:h,ratio:a}};let r=function(){function t(t){let i=n(t)/t.length,e=n(t,2),r=new Array(100).fill(0);for(let n=0;n<t.length;n++){for(let e=0;e<r.length;e++){if(n-e>0){r[e]+=(t[n]-i)*(t[n-e]-i)}}}return r.map(function(n){return n/(e-t.length*i*i)})}return function(n){return n.map(function(n){return t(n)})}}();let h=function(t,n){let e=n&&typeof n.min!=="undefined"?n.min:null,r=n&&typeof n.max!=="undefined"?n.max:null,h=Math.random(),a=new u.Exponential(1);function o(t){return(!e||t>=e[0])&&(!r||t>=r[0])}function s(n,i,e,r){let a=e,u=r,o=false;while(u-a>1.1){let e=(a+u)/2;o=h<e&&n>=e||h>=e&&n<e;if(n<e){u=e}else{a=e}if(o&&i>=t(a)&&i>=t(u)){return false}}return true}function p(){let n=t(h)-a.sample(),e=h-Math.random(),r=e+1;while(n<t(e)||n<t(r)){if(Math.random()<.5){e-=r-e}else{r+=r-e}}let u=i(e,r);while(!o(u)||n>t(u)||!s(u,n,e,r)){if(u<h){e=u}else{r=u}u=i(e,r)}h=u;return h}function f(){return null}function c(t){return new Array(t||1e6).fill(0).map(function(){return[p()]})}return{burnIn:f,sample:c}};let a=function(t,i,h){let a=i&&typeof i.dim==="number"?i.dim:1,o=i&&typeof i.min!=="undefined"?i.min:null,s=i&&typeof i.max!=="undefined"?i.max:null;let p={x:h&&h.x||Array.from({length:a},Math.random),proposals:h&&h.proposals||null,samplingRate:h&&h.samplingRate||1};let f=new e(a,p.proposals);let c=Array.from({length:a},()=>new u.Normal(0,1));let l=t(p.x);let m=function(){let t=0,n=new Array(a).fill(0),i=new Array(a).fill(0);return{get:function(){let t=i.map(function(t,i){return Math.sqrt(t-n[i]*n[i])});let e=t.map(function(t,i){return t/n[i]});return{mean:n,std:t,cv:e}},update:function(e){n=n.map(function(n,i){return(t*n+e[i])/(t+1)});i=i.map(function(n,i){return(t*n+e[i]*e[i])/(t+1)});t++}}}();let M=function(){let t=[];return{get:function(){return n(t)/t.length},update:function(n){t.push(n);if(t.length>1e4){t.shift()}}}}();let g=function(){let t=Array.from({length:a},()=>[]);return{get:function(){return t},update:function(n){t.forEach(function(t,i){t.push(n[i])});if(t[0].length>=1e4){t.forEach(function(t){t.shift()})}}}}();function d(){let n=f.sample(p.x);if(o){for(let t=0;t<n.length;t++){if(n[t]<o[t]){return 0}}}if(s){for(let t=0;t<n.length;t++){if(n[t]>s[t]){return 0}}}let i=t(n);if(Math.random()<f.ratio(p.x,n)*Math.exp(i-l)){p.x=n;l=i;g.update(p.x);m.update(p.x);return 1}else{g.update(p.x);m.update(p.x);return 0}}function x(){p.proposals=f.update(M.get()>.234);let t=r(g.get()).reduce(function(t,n){for(let i=0;i<n.length-1;i++){if(Math.abs(n[i])<=.05){return Math.max(t,i)}}},0);if(t>p.samplingRate){p.samplingRate++}else if(t<p.samplingRate&&p.samplingRate>1){p.samplingRate--}}function w(){return{x:p.x.slice(),proposals:p.proposals,samplingRate:p.samplingRate}}function b(){return m.get()}function y(){return M.get()}function I(){return r(g.get())}function _(t,n){let i=n||100;for(let n=0;n<=i;n++){for(let t=0;t<1e4;t++){M.update(d())}x();t&&t(n/i,M.get())}}function A(t,n){let i=p.samplingRate*(t||1e6),e=i/100,r=[];for(let t=0;t<i;t++){d();if(t%e===0){n&&n(t/e)}if(t%p.samplingRate===0){r.push(p.x)}}return r}return{burnIn:_,sample:A,state:w,stats:b,ar:y,ac:I}};return{gr:t,Slice:h,Metropolis:a}}();let s={};t.special=h;t.core=a;t.dist=u;t.mc=o});