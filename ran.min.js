(function(n,r){if(typeof exports==="object"&&typeof module!=="undefined"){r(exports)}else if(typeof define==="function"&&define["amd"]){define(["exports"],r)}else{r(n.ran=n["ran"]||{})}})(this,function(n){"use strict";function r(n,r){if(r&&r!==1){return n.reduce(function(n,t){return n+Math.pow(t,r)},0)}else{return n.reduce(function(n,r){return n+r},0)}}function t(n,r){return n<r?Math.random()*(r-n)+n:Math.random()*(n-r)+r}function a(n,r){if(r===null||r===undefined||r<2)return n();else{var t=new Array(r);for(var a=0;a<r;a++)t[a]=n();return t}}var e=function(){var n=100;var r=1e-10;var t=function(){var n=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];function r(t){var a=0;if(t<.5){a=Math.PI/(Math.sin(Math.PI*t)*r(1-t))}else{t--;var e=.9999999999998099,u=n.length;n.forEach(function(n,r){e+=n/(t+r+1);var o=t+u-.5;a=Math.sqrt(2*Math.PI)*Math.pow(o,t+.5)*Math.exp(-o)*e})}return a}return r}();var a=function(){var n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];return function(r){var t=r,a=r,e=t+5.5;e=(t+.5)*Math.log(e)-e;var u=1.000000000190015;for(var o=0;o<6;o++){a++;u+=n[o]/a}return e+Math.log(2.5066282746310007*u/t)}}();var e=function(){var a=1e-30;function e(t,a){if(a<0){return 0}else{var e=t,u=1/t,o=1/t;for(var i=0;i<n;i++){e++;u*=a/e;o+=u;if(u<o*r)break}return Math.exp(-a)*Math.pow(a,t)*o}}function u(t,e){var u=e+1-t,o=1/a,i=1/u,f=i,h,c;for(var v=1;v<n;v++){h=v*(t-v);u+=2;i=h*i+u;if(Math.abs(i)<a)i=a;i=1/i;o=u+h/o;if(Math.abs(o)<a)o=a;c=o*i;f*=c;if(Math.abs(c-1)<r)break}return Math.exp(-e)*Math.pow(e,t)*f}return function(n,r){if(r<n+1)return e(n,r);else return t(n)-u(n,r)}}();var u=function(){var t=1e-30;function e(a,e,u){var o=a+e,i=a+1,f=a-1,h=1,c=1-o*u/i;if(Math.abs(c)<t)c=t;c=1/c;var v=c;for(var l=1;l<n;l++){var s=2*l,M=l*(e-l)*u/((f+s)*(a+s));c=1+M*c;if(Math.abs(c)<t)c=t;h=1+M/h;if(Math.abs(h)<t)h=t;c=1/c;v*=c*h;M=-(a+l)*(o+l)*u/((a+s)*(i+s));c=1+M*c;if(Math.abs(c)<t)c=t;h=1+M/h;if(Math.abs(h)<t)h=t;c=1/c;var p=c*h;v*=p;if(Math.abs(p-1)<r)break}return v}return function(n,r,t){var u=t<=0||t>=1?0:Math.exp(a(n+r)-a(n)-a(r)+n*Math.log(t)+r*Math.log(1-t));return t<(n+1)/(n+r+2)?u*e(n,r,t)/n:1-u*e(r,n,1-t)/r}}();var o=function(){var n=[-1.26551223,1.00002368,.37409196,.09678418,-.18628806,.27886807,-1.13520398,1.48851587,-.82215223,.17087277];return function(r){var t=1/(1+.5*Math.abs(r));var a=1;var e=0;n.forEach(function(n){e+=n*a;a*=t});var u=t*Math.exp(e-r*r);return r<0?u-1:1-u}}();return{gamma:t,gammaLn:a,gammaLowerIncomplete:e,betaIncomplete:u,erf:o}}();var u=function(){function n(n,r,e){if(arguments.length===0)return t(0,1);if(arguments.length===1)return t(0,n);return a(function(){return t(n,r)},e)}function r(n,r,e){if(arguments.length===1)return Math.floor(t(0,n+1));return a(function(){return Math.floor(t(n,r+1))},e)}function e(n,r){if(n===null||n===undefined||n.length===0)return null;return a(function(){return n[Math.floor(t(0,n.length))]},r)}function u(n,r){if(n===null||n===undefined||n.length===0)return"";return a(function(){return n.charAt(Math.floor(t(0,n.length)))},r)}function o(n){var r,t,a=n.length;while(a){r=Math.floor(Math.random()*a--);t=n[a];n[a]=n[r];n[r]=t}return n}function i(n,r,t,e){var u=t?t:.5;return a(function(){return Math.random()<u?n:r},e)}return{float:n,int:r,choice:e,char:u,shuffle:o,coin:i}}();var o=function(){var n=[0,7.879,10.597,12.838,14.86,16.75,18.548,20.278,21.955,23.589,25.188,26.757,28.3,29.819,31.319,32.801,34.267,35.718,37.156,38.582,39.997,41.401,42.796,44.181,45.559,46.928,48.29,49.645,50.993,52.336,53.672,55.003,56.328,57.648,58.964,60.275,61.581,62.883,64.181,65.476,66.766,68.053,69.336,70.616,71.893,73.166,74.437,75.704,76.969,78.231,79.49,80.747,82.001,83.253,84.502,85.749,86.994,88.236,89.477,90.715,91.952,93.186,94.419,95.649,96.878,98.105,99.33,100.554,101.776,102.996,104.215,105.432,106.648,107.862,109.074,110.286,111.495,112.704,113.911,115.117,116.321,117.524,118.726,119.927,121.126,122.325,123.522,124.718,125.913,127.106,128.299,129.491,130.681,131.871,133.059,134.247,135.433,136.619,137.803,138.987,140.169,141.351,142.532,143.712,144.891,146.07,147.247,148.424,149.599,150.774,151.948,153.122,154.294,155.466,156.637,157.808,158.977,160.146,161.314,162.481,163.648,164.814,165.98,167.144,168.308,169.471,170.634,171.796,172.957,174.118,175.278,176.438,177.597,178.755,179.913,181.07,182.226,183.382,184.538,185.693,186.847,188.001,189.154,190.306,191.458,192.61,193.761,194.912,196.062,197.211,198.36,199.509,200.657,201.804,202.951,204.098,205.244,206.39,207.535,208.68,209.824,210.968,212.111,213.254,214.396,215.539,216.68,217.821,218.962,220.102,221.242,222.382,223.521,224.66,225.798,226.936,228.074,229.211,230.347,231.484,232.62,233.755,234.891,236.026,237.16,238.294,239.428,240.561,241.694,242.827,243.959,245.091,246.223,247.354,248.485,249.616,250.746,251.876,253.006,254.135,255.264,256.393,257.521,258.649,259.777,260.904,262.031,263.158,264.285,265.411,266.537,267.662,268.788,269.912,271.037,272.162,273.286,274.409,275.533,276.656,277.779,278.902,280.024,281.146,282.268,283.39,284.511,285.632,286.753,287.874,288.994,290.114,291.234,292.353,293.472,294.591,295.71,296.828,297.947,299.065,300.182,301.3,302.417,303.534,304.651,305.767,306.883,307.999,309.115,310.231,311.346];var r=[366.844,421.9,476.606,531.026,585.207,639.183,692.982,746.625,800.131,853.514,906.786,959.957,1013.036,1066.031,1118.948];function t(n,r){var t=Math.random(),a=Math.random();return r*Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*a)+n}function u(n,r){if(n>1){var a=n-1/3;var e=1/Math.sqrt(9*a),o,i,f;while(true){o=t(0,1);if(o>-1/e){i=Math.pow(1+e*o,3);f=Math.random();if(Math.log(f)<.5*o*o+a*(1-i+Math.log(i)))return a*i/r}}}else{return u(n+1,r)*Math.pow(Math.random(),1/n)}}function o(n){var r=[n(0,args)];for(var t=1;t<1e3;t++){r.push(r[t-1]+n(t,args))}return function(n){return r[n]}}function i(t,a,e){var u={};t.forEach(function(n){u[n]=u[n]?u[n]+1:1});var o=0;var i=t.length;for(var f in u){var h=a(parseInt(f))*i;o+=Math.pow(u[f]-h,2)/h}var c=Math.max(1,Object.keys(u).length-e-1);var v=c<=250?n[c]:r[Math.floor(c/50)];return{statistics:o,passed:o<=v}}function f(n){var r=.001;var t=[n(0,args)];for(var a=0;a<100/r;a++){t.push(t[a-1]+n(a*r,args)*r)}return function(a){var e=1e-4;var u=t[parseInt(Math.floor(a/r))];for(var o=parseInt(Math.floor(a/r))+e;o<a;o+=e){u+=n(o,args)*e}return u}}function h(n,r){n.sort(function(n,r){return n-r});var t=0;for(var a=0;a<n.length;a++){t=Math.max(t,Math.abs((a+1)/n.length-r(n[a])))}return{statistics:t,passed:t<=1.628/Math.sqrt(n.length)}}function c(n,r,t,e){return function(){var u=arguments.length;var c={sample:function(n){return a(function(){return r()},n)}};if(n==="discrete"){c.pmf=t}else{c.pdf=t}c.test=function(r){return n==="discrete"?i(r,t,u):h(r,e)};c.cdf=e!==undefined?e:n==="discrete"?o:f;c.survival=function(n){return 1-c.cdf(n)};c.hazard=function(n){return t(n)/c.survival(n)};c.cumulativeHazard=function(n){return-Math.log(c.survival(n))};return c}}var v=function(n){return c("discrete",function(){return Math.random()<n?1:0},function(r){return parseInt(r)===1?n:1-n},function(r){return r<0?0:parseInt(r)>=1?1:1-n})()};var l=function(n,r){var t=Math.exp(e.gammaLn(n)+e.gammaLn(r)-e.gammaLn(n+r));return c("continuous",function(){var t=u(n,1);var a=u(r,1);return t/(t+a)},function(a){return Math.pow(a,n-1)*Math.pow(1-a,r-1)/t},function(t){return t<=0?0:t>=1?1:e.betaIncomplete(n,r,t)})()};var s=function(n,r){var t=r<=.5?r:1-r,a=n*t;return c("discrete",function(){if(n<25){return function(){var a=0;for(var e=1;e<=n;e++)if(Math.random()<t)a++;return t===r?a:n-a}}else if(a<1){var u=Math.exp(-a);return function(){var a=1;for(var e=0;e<=n;e++){a*=Math.random();if(a<u)break}var o=e<=n?e:n;return t===r?o:n-o}}else{var o=n,i=e.gammaLn(o+1),f=1-t,h=Math.log(t),c=Math.log(f),v=Math.sqrt(2*a*f);return function(){do{do{var u=Math.tan(Math.PI*Math.random()),f=v*u+a}while(f<0||f>=o+1);f=Math.floor(f);var l=1.2*v*(1+u*u)*Math.exp(i-e.gammaLn(f+1)-e.gammaLn(o-f+1)+f*h+(o-f)*c)}while(Math.random()>l);return t===r?f:n-f}}}(),function(t){var a=parseInt(t);return a<0?0:a>n?0:Math.exp(e.gammaLn(n+1)-e.gammaLn(a+1)-e.gammaLn(n-a+1)+a*Math.log(r)+(n-a)*Math.log(1-r))},function(t){var a=parseInt(t);return a<=0?0:a>n?1:e.betaIncomplete(n-a,1+a,1-r)})()};var M=function(n,r,t){var a=Math.pow(n,t);var e=Math.pow(r,t);var u=1-Math.pow(n/r,t);return new c("continuous",function(){return Math.pow((e+Math.random()*(a-e))/(a*e),-1/t)},function(a){return a<n||a>r?0:t*Math.pow(n/a,t)/(a*u)},function(u){return u<n?0:u>r?1:(1-a*Math.pow(u,-t))/(1-a/e)})()};var p=function(n){return x(Math.round(n)/2,.5)};var m=function(n){var r=n.length;var t=[0];var a=[0];if(n.length>1){var e=0;for(var u=0;u<r;u++)e+=n[u];var o=[];var i=[];var f=[];for(u=0;u<r;u++){o.push(r*n[u]/e);if(o[u]<1)i.push(u);else f.push(u)}t=[];a=[];for(u=0;u<r;u++){t.push(1);a.push(u)}var h=0,v=0;while(i.length>0&&f.length>0){h=i.shift();v=f.shift();t[h]=o[h];a[h]=v;o[v]+=o[h]-1;if(o[v]<1)i.push(v);else f.push(v)}while(f.length>0){v=f.shift();t[v]=1;a[v]=v}while(i.length>0){h=i.shift();t[h]=1;a[h]=h}}var l=[n[0]/e];var s=[n[0]/e];for(u=1;u<n.length;u++){l.push(n[u]/e);s.push(s[u-1]+n[u]/e)}return new c("discrete",function(){if(r<=1){return 0}var n=Math.floor(Math.random()*r);if(Math.random()<t[n])return n;else return a[n]},function(r){var t=parseInt(r);return t<0||t>=n.length?0:l[t]},function(r){var t=parseInt(r);return t<0?0:t>=n.length?1:s[t]})()};var g=function(n){return new c("continuous",function(){return n},function(r){return r===n?1:0},function(r){return r<n?0:r>n?1:.5})()};var d=function(n,r){return x(Math.round(n),r)};var w=function(n){return new c("continuous",function(){return-Math.log(Math.random())/n},function(r){return n*Math.exp(-n*r)},function(r){return 1-Math.exp(-n*r)})()};var x=function(n,r){var t=Math.pow(r,n);var a=e.gamma(n);return new c("continuous",function(){return u(n,r)},function(e){return e<=0?0:t*Math.exp((n-1)*Math.log(e)-r*e)/a},function(t){return e.gammaLowerIncomplete(n,r*t)/a})()};var I=function(n,r,t){var a=e.gamma(r/t);var o=t/Math.pow(n,r);var i=1/Math.pow(n,t);return new c("continuous",function(){return Math.pow(u(r/t,i),1/t)},function(e){return e<=0?0:o*Math.exp((r-1)*Math.log(e)-Math.pow(e/n,t))/a},function(u){return e.gammaLowerIncomplete(r/t,Math.pow(u/n,t))/a})()};var b=function(n,r){var t=e.gamma(n);var a=Math.pow(r,n)/t;return new c("continuous",function(){return 1/u(n,r)},function(t){return t<=0?0:a*Math.pow(t,-1-n)*Math.exp(-r/t)},function(a){return 1-e.gammaLowerIncomplete(n,r/a)/t})()};var L=function(n,r){var a=r*Math.SQRT2;var u=r*Math.sqrt(2*Math.PI);return new c("continuous",function(){return Math.exp(n+r*t(0,1))},function(t){return t<=0?0:Math.exp(-.5*Math.pow((Math.log(t)-n)/r,2))/(t*u)},function(r){return r<=0?0:.5*(1+e.erf((Math.log(r)-n)/a))})()};var y=function(n,r){var a=r*Math.SQRT2;var u=r*Math.sqrt(2*Math.PI);return new c("continuous",function(){return t(n,r)},function(t){return Math.exp(-.5*Math.pow((t-n)/r,2))/u},function(r){return.5*(1+e.erf((r-n)/a))})()};var P=function(n,r){return new c("continuous",function(){return n/Math.pow(Math.random(),1/r)},function(t){return t<n?0:r*Math.pow(n/t,r)/t},function(t){return t<n?0:1-Math.pow(n/t,r)})()};var q=function(n){return new c("discrete",function(){if(n<30){return function(){var r=Math.exp(-n),t=0,a=1;do{t++;a*=Math.random()}while(a>r);return t-1}}else{var r=.767-3.36/n;var t=Math.PI/Math.sqrt(3*n);var a=t*n;var u=Math.log(r)-n-Math.log(t);return function(){while(true){var r=Math.random();var o=(a-Math.log((1-r)/r))/t;var i=Math.floor(o+.5);if(i<0)continue;var f=Math.random();var h=a-t*o;var c=h+Math.log(f/Math.pow(1+Math.exp(h),2));var v=u+i*Math.log(n)-e.gammaLn(i+1);if(c<=v)return i}}}}(),function(r){var t=parseInt(r);return t<0?0:Math.pow(n,t)*Math.exp(-n)/e.gamma(t+1)},function(r){var t=parseInt(r);return t<0?0:1-e.gammaLowerIncomplete(t+1,n)/e.gamma(t+1)})()};var A=function(n,r){var t=r-n;return new c("continuous",function(){return Math.random()*t+n},function(a){return a<n||a>r?0:1/t},function(a){return a<n?0:a>r?1:(a-n)/t})()};var E=function(n,r){var t=r-n+1;return new c("discrete",function(){return parseInt(Math.random()*t)+n},function(a){var e=parseInt(a);return e<n||e>r?0:1/t},function(a){var e=parseInt(a);return e<n?0:e>r?1:(1+e-n)/t})()};var k=function(n,r){return new c("continuous",function(){return n*Math.pow(-Math.log(Math.random()),1/r)},function(t){return t<0?0:r/n*Math.exp((r-1)*Math.log(t/n)-Math.pow(t/n,r))},function(t){return t<0?0:1-Math.exp(-Math.pow(t/n,r))})()};return{Bernoulli:v,Beta:l,Binomial:s,BoundedPareto:M,Chi2:p,Custom:m,Degenerate:g,Erlang:d,Exponential:w,Gamma:x,GeneralizedGamma:I,InverseGamma:b,Lognormal:L,Normal:y,Pareto:P,Poisson:q,UniformContinuous:A,UniformDiscrete:E,Weibull:k}}();var i=function(){var n=function(){function n(n,t){var a=[],e=[];n.forEach(function(n){var u=n.map(function(n){return n[t]});var o=r(u)/u.length;var i=(r(u,2)-u.length*o*o)/(u.length-1);a.push(o);e.push(i)});var u=r(e)/n.length;var o=r(a)/n.length;var i=(r(a,2)-n.length*o*o)*n[0].length/(n.length-1);var f=((n[0].length-1)*u+i)/n[0].length;return Math.sqrt(f/u)}return function(r,t){return r[0][0].map(function(a,e){return new Array(t||1e3).fill(0).map(function(t,a){return n(r.map(function(n){return n.slice(0,a+2)}),e)})})}}();var t=function(n,r){var t=r||new Array(n).fill(1);var a=new Array(n).fill(0).map(function(){return new o.Normal(0,1)});function e(r){var e=parseInt(Math.random()*n);t[e]=r?t[e]*1.1:t[e]*.9;a[e]=new o.Normal(0,t[e]);return t}function u(n){return n.map(function(n,r){return n+a[r].sample()})}function i(n,r){return 1}return{update:e,sample:u,ratio:i}};var a=function(){function n(n){var t=r(n)/n.length,a=r(n,2);var e=new Array(100).fill(0);for(var u=0;u<n.length;u++){for(var o=0;o<e.length;o++){if(u-o>0){e[o]+=(n[u]-t)*(n[u-o]-t)}}}return e.map(function(r){return r/(a-n.length*t*t)})}return function(r){return r.map(function(r){return n(r)})}}();var e=function(n,e,u){var o={x:u&&u.x||new Array(e).fill(0).map(Math.random),min:u&&u.min||null,max:u&&u.max||null,proposals:u&&u.proposals||null};var i=new t(e,o.proposals);var f=n(o.x);var h=1;var c=function(){var n=0,r=new Array(e).fill(0),t=new Array(e).fill(0);return{get:function(){var n=t.map(function(n,t){return Math.sqrt(n-r[t]*r[t])});var a=n.map(function(n,t){return n/r[t]});return{mean:r,std:n,cv:a}},update:function(a){r=r.map(function(r,t){return(n*r+a[t])/(n+1)});t=t.map(function(r,t){return(n*r+a[t]*a[t])/(n+1)});n++}}}();var v=function(){var n=[];return{get:function(){return r(n)/n.length},update:function(r){n.push(r);if(n.length>1e3){n.shift()}}}}();var l=function(){var n=new Array(e).fill([]);return{get:function(){return n},update:function(r){n.forEach(function(n,t){n.push(r[t])});if(n[0].length>=1e3){n.forEach(function(n){n.shift()})}}}}();function s(){var r=i.sample(o.x);if(o.min){for(var t=0;t<r.length;t++){if(r[t]<o.min[t]){return 0}}}if(o.max){for(t=0;t<r.length;t++){if(r[t]>o.max[t]){return 0}}}var a=n(r);if(Math.random()<i.ratio(o.x,r)*Math.exp(a-f)){o.x=r;f=a;l.update(o.x);c.update(o.x);return 1}else{l.update(o.x);c.update(o.x);return 0}}function M(){o.proposals=i.update(v.get()>.5);var n=a(l.get()).reduce(function(n,r){for(var t=0;t<r.length-1;t++){if(r[t]>=0&&r[t+1]<0){return Math.max(n,t)}}},0);if(n>h){h++}else if(n<h){h--}}function p(){return{x:o.x.slice(),min:o.min,max:o.max,proposals:o.proposals.slice()}}function m(){return c.get()}function g(){return v.get()}function d(){return a(l.get())}function w(n,r){var t=r||100;for(var a=0;a<=t;a++){for(var e=0;e<1e4;e++){v.update(s())}M();n&&n(a/t,v.get())}}function x(n,r){var t=r||1e6;var a=t/100;var e=[];for(var u=0;u<t;u++){s();if(u%a===0){n&&n(u/a)}if(u%h===0){e.push(o.x)}}return e}return{burnIn:w,sample:x,state:p,stats:m,ar:g,ac:d}};return{gr:n,Metropolis:e}}();var f=function(){function n(){}function r(n,r){}function t(){}function a(){}function e(){}}();n.special=e;n.core=u;n.dist=o;n.mc=i});