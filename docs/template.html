<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:200,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Cutive+Mono" rel="stylesheet">    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" href="styles/atelier-lakeside-light.css">
    <script src="highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <title>{{NAME}}</title>
    <style>
        span.hl {
            font-weight: 400;
            color: dodgerblue;
        }
    </style>
</head>
<body>
<aside>
    <div class="search-bar">
        <input id="search" type="search" placeholder="search">
    </div>
    {{API_MENU}}
</aside>
<main>{{API_CONTENT}}</main>
<script>
    let toc = (function(index) {
        let sections = index.reduce((table, d) => {
            let entry = d.split('.');
            let name = entry.shift();
            table[name] = {
                n: 0,
                el: document.getElementById("toc-" + name)
            };
            return table;
        }, {});
        let entries = index.reduce((table, d) => {
            let name = d.split('.');
            let section = name.shift();
            table[name.join('.')] = {
                sec: sections[section],
                el: document.getElementById("toc-" + d)
            };
            sections[section].t++;
            return table;
        }, {});
        let idx = Object.keys(entries);

        function show(keyword) {
            Object.keys(sections).forEach(d => sections[d].n = 0);
            idx.forEach(d => {
                let on = d.toLowerCase().indexOf(keyword) > -1;
                entries[d].el.style.display = on ? "block" : "none";
                entries[d].sec.n += on ? 1 : 0;
            });
            Object.values(sections).forEach(d => {
                d.el.style.display = d.n > 0 ? "block" : "none";
            });
        }

        return {
            show: show
        };
    })(SEARCH_LIST);

    document.getElementById("search").addEventListener("input", function() {
        toc.show(this.value);
    });
</script>
</body>
</html>
